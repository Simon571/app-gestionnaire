(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1431],{3998:(e,s,t)=>{"use strict";t.d(s,{Button:()=>c,r:()=>o});var r=t(95155),a=t(12115),i=t(17129),l=t(83101),n=t(92033),d=t(64269);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,s)=>{let{className:t,variant:a,size:l,asChild:c=!1,loading:u=!1,loadingText:m="Patientez...",children:p,...x}=e,h=c?i.DX:"button",f=u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{className:"mr-2 h-4 w-4 animate-spin"}),m]}):(0,r.jsx)(r.Fragment,{children:p});return(0,r.jsx)(h,{className:(0,d.cn)(o({variant:a,size:l,className:t})),ref:s,disabled:u,"aria-busy":u,...x,children:c?p:f})});c.displayName="Button"},11186:(e,s,t)=>{"use strict";t.d(s,{bq:()=>m,eb:()=>f,gC:()=>h,l6:()=>c,yv:()=>u});var r=t(95155),a=t(12115),i=t(4729),l=t(59007),n=t(42614),d=t(72251),o=t(64269);let c=i.bL;i.YJ;let u=i.WT,m=a.forwardRef((e,s)=>{let{className:t,children:a,...n}=e;return(0,r.jsxs)(i.l9,{ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[a,(0,r.jsx)(i.In,{asChild:!0,children:(0,r.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=i.l9.displayName;let p=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.PP,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=i.PP.displayName;let x=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.wn,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})});x.displayName=i.wn.displayName;let h=a.forwardRef((e,s)=>{let{className:t,children:a,position:l="popper",...n}=e;return(0,r.jsx)(i.ZL,{children:(0,r.jsxs)(i.UC,{ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...n,children:[(0,r.jsx)(p,{}),(0,r.jsx)(i.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(x,{})]})})});h.displayName=i.UC.displayName,a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.JU,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a})}).displayName=i.JU.displayName;let f=a.forwardRef((e,s)=>{let{className:t,children:a,...l}=e;return(0,r.jsxs)(i.q7,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.VF,{children:(0,r.jsx)(d.A,{className:"h-4 w-4"})})}),(0,r.jsx)(i.p4,{children:a})]})});f.displayName=i.q7.displayName,a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.wv,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",t),...a})}).displayName=i.wv.displayName},11647:(e,s,t)=>{"use strict";t.d(s,{E:()=>n});var r=t(95155);t(12115);var a=t(83101),i=t(64269);let l=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)(l({variant:t}),s),...a})}},13406:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>o,av:()=>c,j7:()=>d,tU:()=>n});var r=t(95155),a=t(12115),i=t(25667),l=t(64269);let n=i.bL,d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.B8,{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})});d.displayName=i.B8.displayName;let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.l9,{ref:s,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})});o.displayName=i.l9.displayName;let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.UC,{ref:s,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})});c.displayName=i.UC.displayName},15894:(e,s,t)=>{"use strict";t.d(s,{dj:()=>u});var r=t(12115);let a=0,i=new Map,l=e=>{if(i.has(e))return;let s=setTimeout(()=>{i.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,s)},n=[],d={toasts:[]};function o(e){d=((e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?l(t):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}})(d,e),n.forEach(e=>{e(d)})}function c(e){let{...s}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>o({type:"DISMISS_TOAST",toastId:t});return o({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,s]=r.useState(d);return r.useEffect(()=>(n.push(s),()=>{let e=n.indexOf(s);e>-1&&n.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},17037:(e,s,t)=>{"use strict";t.d(s,{F:()=>n});var r=t(95155),a=t(12115),i=t(59034),l=t(64269);let n=a.forwardRef((e,s)=>{let{className:t,children:a,...n}=e;return(0,r.jsxs)(i.bL,{ref:s,className:(0,l.cn)("relative overflow-hidden",t),...n,children:[(0,r.jsx)(i.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,r.jsx)(d,{}),(0,r.jsx)(i.OK,{})]})});n.displayName=i.bL.displayName;let d=a.forwardRef((e,s)=>{let{className:t,orientation:a="vertical",...n}=e;return(0,r.jsx)(i.VM,{ref:s,orientation:a,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:(0,r.jsx)(i.lr,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=i.VM.displayName},50428:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var r=t(95155),a=t(12115),i=t(86948),l=t(87270),n=t(13406),d=t(17037),o=t(3998),c=t(76251),u=t(18155),m=t(94979),p=t(64269),x=t(73457),h=t(11186),f=t(50425),j=t(15894),b=t(11647);let v=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={publishers:{reports:0,studies:0,hours:null},auxiliary_pioneers:{reports:0,studies:0,hours:0},permanent_pioneers:{reports:0,studies:0,hours:0},special_pioneers:{reports:0,studies:0,hours:0},missionaries:{reports:0,studies:0,hours:0},direct_reports:{reports:0,studies:0,hours:0},weekend_attendance:0,publisherReports:[]},a=s.map(s=>{var r,a,i,l,n,d,o,c,u,m,p,x,h,f,j;let b=null==(r=s.activity)?void 0:r.find(s=>s.month===e),v=t["".concat(s.id,"_").concat(e)],y=!!v,N=y?null!=(n=null==v||null==(a=v.totals)?void 0:a.hours)?n:0:null!=(d=null==b?void 0:b.hours)?d:null,g=y?null!=(o=null==v||null==(i=v.totals)?void 0:i.bibleStudies)?o:0:null!=(c=null==b?void 0:b.bibleStudies)?c:null,w=y?null!=(u=null==v||null==(l=v.totals)?void 0:l.credit)?u:0:null!=(m=null==b?void 0:b.credit)?m:null,_=y?null!=(p=null==v?void 0:v.didPreach)?p:null!==N&&N>0||null!==g&&g>0:null!=(x=null==b?void 0:b.participated)&&x;return{id:s.id,lastName:s.lastName,firstName:s.firstName,status:null==v?void 0:v.status,participated:_,studies:g,isAuxiliary:null!=(h=null==b?void 0:b.isAuxiliaryPioneer)&&h,hours:N,credit:w,isLate:null!=(f=null==b?void 0:b.isLate)&&f,remarks:null!=(j=null==b?void 0:b.remarks)?j:null,pioneerStatus:s.spiritual.pioneer.status}}).sort((e,s)=>{let t=e.lastName.localeCompare(s.lastName,"fr",{sensitivity:"base"});return 0!==t?t:e.firstName.localeCompare(s.firstName,"fr",{sensitivity:"base"})});return a.forEach(e=>{if(e.participated){let s=null;(s="permanent"===e.pioneerStatus?"permanent_pioneers":"special"===e.pioneerStatus?"special_pioneers":"missionary"===e.pioneerStatus?"missionaries":e.isAuxiliary||null!==e.hours&&e.hours>0?"auxiliary_pioneers":"publishers")&&(r[s].reports++,e.studies&&(r[s].studies+=e.studies),e.hours&&null!==r[s].hours&&(r[s].hours+=e.hours))}}),r.publisherReports=a,r},y=[{key:"publishers",label:"Proclamateurs"},{key:"auxiliary_pioneers",label:"Pionniers auxiliaires"},{key:"permanent_pioneers",label:"Pionniers permanents"},{key:"special_pioneers",label:"Pionniers sp\xe9ciaux"},{key:"missionaries",label:"Missionnaires affect\xe9s dans le territoire"},{key:"direct_reports",label:"Rapports envoy\xe9s directement \xe0 la filiale"}];function N(){var e;let{people:s,preachingGroups:t,isLoaded:N}=(0,f.d)(),g=a.useMemo(()=>(()=>{let e=[],s=new Date;for(let t=0;t<24;t++){let r=new Date(s.getFullYear(),s.getMonth()-t,1);e.push({key:"".concat(r.getFullYear(),"-").concat((r.getMonth()+1).toString().padStart(2,"0")),label:r.toLocaleString("fr-FR",{month:"long",year:"numeric"})})}return e})(),[]),[w,_]=a.useState(g[0].key),[A,k]=a.useState("assembly"),[R,S]=a.useState(()=>v(w,s)),[C,T]=a.useState({}),[P,E]=a.useState("not_sent"),[B,z]=a.useState("all"),[I,O]=a.useState("all-groups"),[F,L]=a.useState([]),{toast:M}=(0,j.dj)(),V=a.useMemo(()=>F.find(e=>e.month===w),[F,w]);a.useEffect(()=>{S(v(w,s,C)),E(V?"sent":"not_sent")},[w,s,C,V]),a.useEffect(()=>{(async()=>{try{let e=await fetch("/api/publisher-app/activity");if(!e.ok)return;let s=await e.json();if(!(null==s?void 0:s.reports))return;let t={};for(let e of s.reports)e.userId&&e.month&&(t["".concat(e.userId,"_").concat(e.month)]={status:e.status,totals:e.totals,didPreach:e.didPreach});T(t)}catch(e){console.error("Failed to load preaching activity statuses",e)}})()},[]),a.useEffect(()=>{(async()=>{try{let e=await fetch("/api/publisher-app/activity/submit-to-branch");if(!e.ok)return;let s=await e.json();(null==s?void 0:s.submissions)&&L(s.submissions)}catch(e){console.error("Failed to load month submissions",e)}})()},[]);let Z=a.useMemo(()=>R.publisherReports.filter(e=>{let t=s.find(s=>s.id===e.id);if(!t||"all-groups"!==I&&t.spiritual.group!==I)return!1;switch(B){case"all":default:return!0;case"missing_report":return!e.participated;case"elders":return"elder"===t.spiritual.function;case"servants":return"servant"===t.spiritual.function;case"publishers":return"publisher"===t.spiritual.function;case"unbaptized_publishers":return"unbaptized"===t.spiritual.function;case"auxiliary_pioneers":return e.isAuxiliary;case"permanent_pioneers":return"permanent"===t.spiritual.pioneer.status;case"special_pioneers":return"special"===t.spiritual.pioneer.status;case"missionaries":return"missionary"===t.spiritual.pioneer.status}}),[R.publisherReports,B,s,I]),H=a.useMemo(()=>y.reduce((e,s)=>{let t=R[s.key];if(e.reports+=t.reports,e.studies+=t.studies,null!==t.hours){var r;e.hours=(null!=(r=e.hours)?r:0)+t.hours}return e},{reports:0,studies:0,hours:0}),[R]),q=a.useMemo(()=>({active_publishers:H.reports,irregular_publishers:0,inactive_publishers:0,new_inactive:0,reactivated_publishers:0}),[H.reports]),D=null==(e=g.find(e=>e.key===w))?void 0:e.label,U=async()=>{let e=R.publisherReports.filter(e=>{var s;return!e.participated&&!(null==(s=C["".concat(e.id,"_").concat(w)])?void 0:s.status)}).map(e=>e.id);try{let s=await fetch("/api/publisher-app/activity/submit-to-branch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({month:w,lateUserIds:e})});if(!s.ok)throw Error("submit failed");let t=await s.json();L(e=>[...e.filter(e=>e.month!==w),t.submission]),T(s=>{let t={...s};for(let s of e){let e="".concat(s,"_").concat(w);t[e]={...t[e],isLate:!0}}return t}),E("sent"),M({title:"Rapport envoy\xe9 \xe0 la filiale",description:"Le rapport pour ".concat(D," a \xe9t\xe9 envoy\xe9. ").concat(e.length," proclamateur(s) marqu\xe9(s) en retard.")})}catch(e){console.error(e),M({title:"Erreur",description:"Impossible d'envoyer le rapport \xe0 la filiale.",variant:"destructive"})}},W=async()=>{try{if(!(await fetch("/api/publisher-app/activity/submit-to-branch",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({month:w})})).ok)throw Error("cancel failed");let e=F.find(e=>e.month===w);L(e=>e.filter(e=>e.month!==w)),e&&T(s=>{let t={...s};for(let s of e.lateUserIds){let e="".concat(s,"_").concat(w);t[e]&&(t[e]={...t[e],isLate:!1})}return t}),E("not_sent"),M({title:"Envoi annul\xe9",description:"Le rapport pour ".concat(D," a \xe9t\xe9 marqu\xe9 comme non envoy\xe9."),variant:"destructive"})}catch(e){console.error(e),M({title:"Erreur",description:"Impossible d'annuler l'envoi.",variant:"destructive"})}},X=async e=>{try{var s,t,r;let a=await fetch("/api/publisher-app/activity",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,month:w,status:"validated"})});if(!a.ok)throw Error("validate");let i=await a.json().catch(()=>null),l=null!=(r=null==i||null==(s=i.report)?void 0:s.totals)?r:null==(t=C["".concat(e,"_").concat(w)])?void 0:t.totals;T(s=>{var t;return{...s,["".concat(e,"_").concat(w)]:{...null!=(t=s["".concat(e,"_").concat(w)])?t:{},status:"validated",totals:l,didPreach:!0}}}),M({title:"Rapport valid\xe9",description:"Le rapport est maintenant marqu\xe9 comme valid\xe9 et synchronis\xe9 dans la page Personnes."})}catch(e){console.error(e),M({title:"Validation impossible",description:"R\xe9essayez ou v\xe9rifiez la connexion.",variant:"destructive"})}},J=async()=>{let e=Z.filter(e=>{var s;return(null==(s=C["".concat(e.id,"_").concat(w)])?void 0:s.status)==="received"}).map(e=>e.id);if(!e.length)return void M({title:"Rien \xe0 valider",description:"Aucun rapport re\xe7u en attente pour ce mois."});try{await Promise.all(e.map(async e=>{var s;let t=await fetch("/api/publisher-app/activity",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,month:w,status:"validated"})});if(!t.ok)throw Error("validate-all");let r=await t.json().catch(()=>null),a=null==r||null==(s=r.report)?void 0:s.totals;T(s=>{var t;return{...s,["".concat(e,"_").concat(w)]:{...null!=(t=s["".concat(e,"_").concat(w)])?t:{},status:"validated",totals:a,didPreach:!0}}})})),M({title:"Validation group\xe9e",description:"".concat(e.length," rapport(s) valid\xe9(s).")})}catch(e){console.error(e),M({title:"Validation group\xe9e impossible",description:"R\xe9essayez ou v\xe9rifiez la connexion.",variant:"destructive"})}};return N?(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-4",children:[(0,r.jsx)("div",{className:"md:col-span-1 no-print",children:(0,r.jsx)(i.Zp,{children:(0,r.jsx)(d.F,{className:"h-[70vh]",children:(0,r.jsx)("div",{className:"p-2",children:g.map(e=>(0,r.jsx)(o.Button,{variant:"ghost",className:(0,p.cn)("w-full justify-start text-sm",w===e.key&&"bg-accent text-accent-foreground"),onClick:()=>_(e.key),children:e.label.charAt(0).toUpperCase()+e.label.slice(1)},e.key))})})})}),(0,r.jsx)("div",{className:"md:col-span-3",children:(0,r.jsxs)(n.tU,{value:A,onValueChange:k,defaultValue:"assembly",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start no-print",children:[(0,r.jsxs)(n.j7,{children:[(0,r.jsx)(n.Xi,{value:"assembly",children:"Assembl\xe9e"}),(0,r.jsx)(n.Xi,{value:"jw_org",children:"JW.ORG (S-1)"}),(0,r.jsx)(n.Xi,{value:"publishers",children:"Proclamateurs"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["publishers"===A&&(0,r.jsx)(o.Button,{size:"sm",variant:"secondary",onClick:J,children:"Valider tous les re\xe7us"}),(0,r.jsx)(o.Button,{variant:"ghost",size:"icon",onClick:()=>{window.print()},children:(0,r.jsx)(c.A,{className:"h-5 w-5"})}),(0,r.jsx)(o.Button,{variant:"ghost",size:"icon",children:(0,r.jsx)(u.A,{className:"h-5 w-5"})})]})]}),(0,r.jsx)(n.av,{value:"assembly",children:(0,r.jsxs)(i.Zp,{className:"mt-4 printable-area",children:[(0,r.jsx)(i.aR,{className:"no-print",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Activit\xe9 de pr\xe9dication de l'assembl\xe9e"}),(0,r.jsx)(i.ZB,{className:"text-2xl capitalize",children:D})]})}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsxs)("div",{className:"print-only hidden my-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-center",children:"Activit\xe9 de pr\xe9dication de l'assembl\xe9e"}),(0,r.jsx)("h3",{className:"text-lg text-center capitalize",children:D})]}),(0,r.jsxs)(l.XI,{children:[(0,r.jsx)(l.A0,{children:(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nd,{className:"w-2/5",children:"Type"}),(0,r.jsx)(l.nd,{className:"text-right",children:"Nombre de rap"}),(0,r.jsx)(l.nd,{className:"text-right",children:"Cours bibliques"}),(0,r.jsx)(l.nd,{className:"text-right",children:"Heures"})]})}),(0,r.jsxs)(l.BF,{children:[y.map(e=>{var s;return(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nA,{className:"font-medium",children:e.label}),(0,r.jsx)(l.nA,{className:"text-right",children:R[e.key].reports}),(0,r.jsx)(l.nA,{className:"text-right",children:R[e.key].studies}),(0,r.jsx)(l.nA,{className:"text-right",children:null!=(s=R[e.key].hours)?s:"—"})]},e.key)}),(0,r.jsxs)(l.Hj,{className:"font-bold bg-muted/50",children:[(0,r.jsx)(l.nA,{children:"Total"}),(0,r.jsx)(l.nA,{className:"text-right",children:H.reports}),(0,r.jsx)(l.nA,{className:"text-right",children:H.studies}),(0,r.jsx)(l.nA,{className:"text-right",children:H.hours})]})]})]}),(0,r.jsxs)("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 no-print",children:[(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Proclamateurs actifs"}),(0,r.jsx)("span",{children:q.active_publishers})]}),(0,r.jsxs)("div",{className:"flex justify-between text-muted-foreground",children:[(0,r.jsx)("span",{children:"Proclamateurs irr\xe9guliers"}),(0,r.jsx)("span",{children:q.irregular_publishers})]}),(0,r.jsxs)("div",{className:"flex justify-between text-muted-foreground",children:[(0,r.jsx)("span",{children:"Proclamateurs inactifs"}),(0,r.jsx)("span",{children:q.inactive_publishers})]}),(0,r.jsxs)("div",{className:"flex justify-between text-muted-foreground",children:[(0,r.jsx)("span",{children:"Nouveaux proclamateurs inactifs"}),(0,r.jsx)("span",{children:q.new_inactive})]}),(0,r.jsxs)("div",{className:"flex justify-between text-muted-foreground",children:[(0,r.jsx)("span",{children:"Proclamateurs r\xe9activ\xe9s"}),(0,r.jsx)("span",{children:q.reactivated_publishers})]})]}),(0,r.jsx)("div",{className:"flex flex-col items-center justify-end md:items-end mt-6 md:mt-0",children:"not_sent"===P?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-destructive font-semibold mb-2",children:"Non envoy\xe9"}),(0,r.jsxs)(o.Button,{onClick:U,children:[(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Envoy\xe9 \xe0 la filiale"]})]}):(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-green-600 font-semibold",children:"Envoy\xe9"}),(0,r.jsx)(o.Button,{variant:"link",className:"text-destructive hover:text-destructive p-0 h-auto",onClick:W,children:"Annuler l'envoi"})]})})]})]})]})}),(0,r.jsx)(n.av,{value:"jw_org",className:"printable-area",children:(0,r.jsxs)(i.Zp,{className:"mt-4",children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{className:"text-2xl capitalize text-primary",children:D})}),(0,r.jsxs)(i.Wu,{className:"space-y-6",children:[(0,r.jsx)(i.Zp,{children:(0,r.jsxs)(i.Wu,{className:"p-4 space-y-2",children:[(0,r.jsx)("h3",{className:"font-bold text-primary",children:"Proclamateurs actifs"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Compte de tous les membres de l'assembl\xe9e ayant remis un rapport au moins une fois au cours des 6 derniers mois."}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:q.active_publishers}),(0,r.jsx)("hr",{className:"my-2"}),(0,r.jsx)("h3",{className:"font-bold text-primary",children:"Assistance moyenne aux r\xe9unions le week-end"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:R.weekend_attendance})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{className:"text-lg",children:"Proclamateurs"})}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Nombre de rap"}),(0,r.jsx)("span",{className:"font-semibold",children:R.publishers.reports})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Cours bibliques"}),(0,r.jsx)("span",{className:"font-semibold",children:R.publishers.studies})]})]})]}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{className:"text-lg",children:"Pionniers auxiliaires"})}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Nombre de rap"}),(0,r.jsx)("span",{className:"font-semibold",children:R.auxiliary_pioneers.reports})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Heures"}),(0,r.jsx)("span",{className:"font-semibold",children:R.auxiliary_pioneers.hours})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Cours bibliques"}),(0,r.jsx)("span",{className:"font-semibold",children:R.auxiliary_pioneers.studies})]})]})]}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{className:"text-lg",children:"Pionniers permanents"})}),(0,r.jsxs)(i.Wu,{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Nombre de rap"}),(0,r.jsx)("span",{className:"font-semibold",children:R.permanent_pioneers.reports})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Heures"}),(0,r.jsx)("span",{className:"font-semibold",children:R.permanent_pioneers.hours})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Cours bibliques"}),(0,r.jsx)("span",{className:"font-semibold",children:R.permanent_pioneers.studies})]})]})]})]}),(0,r.jsx)("div",{className:"flex justify-end pt-4 no-print",children:"sent"===P?(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-green-600 font-semibold",children:"Envoy\xe9"}),(0,r.jsx)(o.Button,{variant:"link",className:"text-destructive hover:text-destructive p-0 h-auto",onClick:W,children:"Annuler l'envoi"})]}):(0,r.jsxs)(o.Button,{onClick:U,children:[(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Envoy\xe9 \xe0 la filiale"]})})]})]})}),(0,r.jsx)(n.av,{value:"publishers",className:"printable-area",children:(0,r.jsxs)(i.Zp,{className:"mt-4",children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Rapports des proclamateurs"}),(0,r.jsx)(i.ZB,{className:"text-2xl capitalize",children:D})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 no-print",children:[(0,r.jsxs)(h.l6,{value:I,onValueChange:O,children:[(0,r.jsx)(h.bq,{className:"w-[180px]",children:(0,r.jsx)(h.yv,{placeholder:"Tous les groupes"})}),(0,r.jsxs)(h.gC,{children:[(0,r.jsx)(h.eb,{value:"all-groups",children:"Tous les groupes"}),t.map(e=>(0,r.jsx)(h.eb,{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)(h.l6,{value:B,onValueChange:z,children:[(0,r.jsx)(h.bq,{className:"w-[220px]",children:(0,r.jsx)(h.yv,{placeholder:"Tous"})}),(0,r.jsxs)(h.gC,{children:[(0,r.jsx)(h.eb,{value:"all",children:"Tous"}),(0,r.jsx)(h.eb,{value:"missing_report",children:"Rapport manquant"}),(0,r.jsx)(h.eb,{value:"elders",children:"Anciens"}),(0,r.jsx)(h.eb,{value:"servants",children:"Assistants"}),(0,r.jsx)(h.eb,{value:"publishers",children:"Proclamateurs"}),(0,r.jsx)(h.eb,{value:"unbaptized_publishers",children:"Proclamateurs non baptis\xe9s"}),(0,r.jsx)(h.eb,{value:"auxiliary_pioneers",children:"Pionniers auxiliaires"}),(0,r.jsx)(h.eb,{value:"permanent_pioneers",children:"Pionniers permanents"}),(0,r.jsx)(h.eb,{value:"special_pioneers",children:"Pionniers sp\xe9ciaux"}),(0,r.jsx)(h.eb,{value:"missionaries",children:"Missionnaires affect\xe9s dans le territoire"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(x.S,{id:"include-inactives"}),(0,r.jsx)("label",{htmlFor:"include-inactives",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Inclure les inactifs"})]})]})]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)(l.XI,{children:[(0,r.jsx)(l.A0,{children:(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nd,{children:"Nom de famille"}),(0,r.jsx)(l.nd,{children:"Pr\xe9nom"}),(0,r.jsx)(l.nd,{children:"Statut"}),(0,r.jsx)(l.nd,{children:"A particip\xe9"}),(0,r.jsx)(l.nd,{children:"Cours bibl."}),(0,r.jsx)(l.nd,{children:"Pion. aux."}),(0,r.jsx)(l.nd,{children:"Heures"}),(0,r.jsx)(l.nd,{children:"Cr\xe9dit"}),(0,r.jsx)(l.nd,{children:"En retard"}),(0,r.jsx)(l.nd,{children:"Remarques"})]})}),(0,r.jsx)(l.BF,{children:Z.map(e=>{var s;return(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nA,{className:"font-medium",children:e.lastName}),(0,r.jsx)(l.nA,{children:e.firstName}),(0,r.jsxs)(l.nA,{className:"space-y-1",children:["validated"===e.status&&(0,r.jsx)(b.E,{className:"bg-green-600 text-white",children:"Valid\xe9"}),"received"===e.status&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(b.E,{className:"bg-amber-500 text-white",children:"Re\xe7u"}),(0,r.jsx)(o.Button,{size:"sm",variant:"secondary",onClick:()=>X(e.id),children:"Valider"})]}),!e.status&&(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"—"})]}),(0,r.jsx)(l.nA,{children:(0,r.jsx)(x.S,{checked:e.participated})}),(0,r.jsx)(l.nA,{children:e.studies}),(0,r.jsx)(l.nA,{children:(0,r.jsx)(x.S,{checked:e.isAuxiliary})}),(0,r.jsx)(l.nA,{children:null!==e.hours?e.hours.toFixed(0):""}),(0,r.jsx)(l.nA,{children:e.credit}),(0,r.jsx)(l.nA,{children:(0,r.jsx)(x.S,{checked:e.isLate||(null==(s=C["".concat(e.id,"_").concat(w)])?void 0:s.isLate)})}),(0,r.jsx)(l.nA,{children:e.remarks})]},e.id)})})]})})]})})]})})]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"Chargement des donn\xe9es..."})})}},51994:(e,s,t)=>{Promise.resolve().then(t.bind(t,50428))},73457:(e,s,t)=>{"use strict";t.d(s,{S:()=>d});var r=t(95155),a=t(12115),i=t(38162),l=t(72251),n=t(64269);let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.bL,{ref:s,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground","accent-amber-500","data-[state=checked]:bg-amber-500 data-[state=checked]:border-amber-500",t),...a,children:(0,r.jsx)(i.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})})});d.displayName=i.bL.displayName},86948:(e,s,t)=>{"use strict";t.d(s,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>l,aR:()=>n,wL:()=>u});var r=t(95155),a=t(12115),i=t(64269);let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});l.displayName="Card";let n=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...a})});n.displayName="CardHeader";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight text-primary",t),...a})});d.displayName="CardTitle";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,i.cn)("p-6 pt-0",t),...a})});c.displayName="CardContent";let u=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",t),...a})});u.displayName="CardFooter"},87270:(e,s,t)=>{"use strict";t.d(s,{A0:()=>n,BF:()=>d,Hj:()=>o,XI:()=>l,nA:()=>u,nd:()=>c});var r=t(95155),a=t(12115),i=t(64269);let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:s,className:(0,i.cn)("w-full caption-bottom text-sm",t),...a})})});l.displayName="Table";let n=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("thead",{ref:s,className:(0,i.cn)("[&_tr]:border-b",t),...a})});n.displayName="TableHeader";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tbody",{ref:s,className:(0,i.cn)("[&_tr:last-child]:border-0",t),...a})});d.displayName="TableBody",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tfoot",{ref:s,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}).displayName="TableFooter";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tr",{ref:s,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})});o.displayName="TableRow";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("th",{ref:s,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})});c.displayName="TableHead";let u=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("td",{ref:s,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})});u.displayName="TableCell",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("caption",{ref:s,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption"}},e=>{e.O(0,[830,3928,5502,9034,3090,7941,8441,1255,7358],()=>e(e.s=51994)),_N_E=e.O()}]);