(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7856],{6447:(e,s,r)=>{"use strict";r.d(s,{A:()=>o});var t=r(95155),l=r(12115),a=r(3998),i=r(92033),n=r(58772),d=r(15894),c=r(10960);function o(e){let{type:s,getPayload:r,save:o,disabled:m,label:x}=e,{toast:h}=(0,d.dj)(),[u,p]=l.useState(!1),j=async()=>{if(!m){p(!0);try{o&&await o();let e=r?r():{};if(!(await (0,c.e)("/api/publisher-app/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:s,payload:e,notify:!0})})).ok)throw Error("Impossible de cr\xe9er le job de synchronisation");h({title:"Enregistr\xe9 et envoy\xe9",description:"Le job a bien \xe9t\xe9 cr\xe9\xe9 pour Publisher App."})}catch(e){console.error("link-to-publisher error",e),h({title:"Erreur",description:(null==e?void 0:e.message)||"Envoi impossible",variant:"destructive"})}finally{p(!1)}}};return(0,t.jsxs)(a.Button,{onClick:j,disabled:m||u,className:"bg-sky-600 hover:bg-sky-700 text-white",children:[u?(0,t.jsx)(i.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(n.A,{className:"mr-2 h-4 w-4"}),null!=x?x:"Enregistrer & Envoyer vers Publisher App"]})}},28262:(e,s,r)=>{Promise.resolve().then(r.bind(r,42733))},42733:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>y});var t=r(95155),l=r(12115),a=r(6447),i=r(86948),n=r(3998),d=r(65142),c=r(76444),o=r(73457),m=r(32265),x=r(81288),h=r(13630),u=r(63037),p=r(44749),j=r(51190),g=r(63263),f=r(46767),b=r(11186),v=r(50425),N=r(37369);function y(){let{preachingGroups:e,isLoaded:s}=(0,v.d)(),{syncPredication:r,isSyncing:y}=(0,N.w)(),[w,C]=(0,l.useState)(new Date(2025,10,5)),[k,S]=(0,l.useState)(null),[A,F]=(0,l.useState)([]),[L,D]=(0,l.useState)("all-groups"),[B,I]=(0,l.useState)({time:"12:00",conductor:"",recurrent:!1,location:"",territories:[],notes:""}),R=async()=>{if(!k)return;let e=[...A,{id:Date.now().toString(),date:k,...B}];F(e),await r({date:k.toISOString(),time:B.time,location:B.location,groups:B.territories,assignments:e.map(e=>({id:e.id,date:e.date.toISOString(),time:e.time,conductor:e.conductor,location:e.location,territories:e.territories}))}),I({time:"12:00",conductor:"",recurrent:!1,location:"",territories:[],notes:""}),S(null)},_=new Date(w.getFullYear(),w.getMonth()+1,0).getDate(),z=new Date(w.getFullYear(),w.getMonth(),1).getDay(),M=Array.from({length:_},(e,s)=>s+1),Z=Array.from({length:0===z?6:z-1},(e,s)=>null);return s?(0,t.jsx)(f.Bc,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsx)(i.Zp,{children:(0,t.jsxs)(i.Wu,{className:"pt-6 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg",children:"R\xe9unions pour la pr\xe9dication"}),(0,t.jsx)("div",{className:"bg-cyan-100 rounded p-4 min-h-[80px] border border-cyan-300",children:k?(0,t.jsx)("p",{className:"text-sm",children:k.toLocaleDateString("fr-FR")}):(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Aucune date s\xe9lectionn\xe9e"})})]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,t.jsxs)(f.m_,{children:[(0,t.jsx)(f.k$,{asChild:!0,children:(0,t.jsx)(n.Button,{size:"sm",variant:"outline",className:"flex-1",children:(0,t.jsx)(m.A,{className:"w-4 h-4"})})}),(0,t.jsx)(f.ZI,{children:"Ajouter"})]}),(0,t.jsxs)(f.m_,{children:[(0,t.jsx)(f.k$,{asChild:!0,children:(0,t.jsx)(n.Button,{size:"sm",variant:"outline",className:"flex-1",children:(0,t.jsx)(x.A,{className:"w-4 h-4"})})}),(0,t.jsx)(f.ZI,{children:"Copier"})]}),(0,t.jsxs)(f.m_,{children:[(0,t.jsx)(f.k$,{asChild:!0,children:(0,t.jsx)(n.Button,{size:"sm",variant:"outline",className:"flex-1",children:(0,t.jsx)(h.A,{className:"w-4 h-4"})})}),(0,t.jsx)(f.ZI,{children:"Supprimer"})]}),(0,t.jsxs)(f.m_,{children:[(0,t.jsx)(f.k$,{asChild:!0,children:(0,t.jsx)(n.Button,{size:"sm",variant:"outline",className:"flex-1",children:(0,t.jsx)(u.A,{className:"w-4 h-4"})})}),(0,t.jsx)(f.ZI,{children:"Archiver"})]}),(0,t.jsxs)(f.m_,{children:[(0,t.jsx)(f.k$,{asChild:!0,children:(0,t.jsx)(n.Button,{size:"sm",variant:"outline",className:"flex-1",children:(0,t.jsx)(p.A,{className:"w-4 h-4"})})}),(0,t.jsx)(f.ZI,{children:"Modifier"})]}),(0,t.jsx)("div",{className:"w-full mt-2",children:(0,t.jsx)(a.A,{type:"predication",getPayload:()=>({generatedAt:new Date().toISOString(),meetings:A}),save:()=>{try{localStorage.setItem("programme-predication",JSON.stringify({meetings:A,savedAt:new Date().toISOString()}))}catch(e){}}})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"time",children:"Heure"}),(0,t.jsxs)(b.l6,{value:B.time,onValueChange:e=>I({...B,time:e}),children:[(0,t.jsx)(b.bq,{id:"time",children:(0,t.jsx)(b.yv,{})}),(0,t.jsx)(b.gC,{children:Array.from({length:24},(e,s)=>{let r=String(s).padStart(2,"0");return(0,t.jsxs)(b.eb,{value:"".concat(r,":00"),children:[r,":00"]},r)})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(c.Label,{htmlFor:"groups",children:["Groupes (",e.length,")"]}),(0,t.jsxs)(b.l6,{value:L,onValueChange:D,children:[(0,t.jsx)(b.bq,{id:"groups",children:(0,t.jsx)(b.yv,{placeholder:"Tous les groupes"})}),(0,t.jsxs)(b.gC,{children:[(0,t.jsx)(b.eb,{value:"all-groups",children:"Tous les groupes"}),e.map(e=>(0,t.jsx)(b.eb,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"conductor",children:"Conducteur"}),(0,t.jsx)(d.p,{id:"conductor",placeholder:"Nom du conducteur",value:B.conductor,onChange:e=>I({...B,conductor:e.target.value})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.S,{id:"recurrent",checked:B.recurrent,onCheckedChange:e=>I({...B,recurrent:e})}),(0,t.jsx)(c.Label,{htmlFor:"recurrent",className:"font-normal cursor-pointer",children:"R\xe9current"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"replacement",children:"Conducteur rempla\xe7ant"}),(0,t.jsx)(d.p,{id:"replacement",placeholder:"Nom du rempla\xe7ant"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"location",children:"Lieu"}),(0,t.jsxs)(b.l6,{children:[(0,t.jsx)(b.bq,{id:"location",children:(0,t.jsx)(b.yv,{placeholder:"S\xe9lectionner un lieu"})}),(0,t.jsxs)(b.gC,{children:[(0,t.jsx)(b.eb,{value:"local1",children:"Lieu 1"}),(0,t.jsx)(b.eb,{value:"local2",children:"Lieu 2"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"territories",children:"Territoires"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.S,{id:"terr1"}),(0,t.jsx)(c.Label,{htmlFor:"terr1",className:"font-normal text-sm cursor-pointer",children:"Territoire 1"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.S,{id:"terr2"}),(0,t.jsx)(c.Label,{htmlFor:"terr2",className:"font-normal text-sm cursor-pointer",children:"Territoire 2"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"notes",children:"Notes"}),(0,t.jsx)("textarea",{id:"notes",className:"w-full min-h-[80px] rounded border border-input bg-background px-3 py-2 text-sm",placeholder:"Ajouter des notes",value:B.notes,onChange:e=>I({...B,notes:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"link",children:"Lien"}),(0,t.jsx)(d.p,{id:"link",placeholder:"Ajouter un lien"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.Label,{htmlFor:"model",children:"Mod\xe8le"}),(0,t.jsxs)(b.l6,{children:[(0,t.jsx)(b.bq,{id:"model",children:(0,t.jsx)(b.yv,{placeholder:"S\xe9lectionner un mod\xe8le"})}),(0,t.jsxs)(b.gC,{children:[(0,t.jsx)(b.eb,{value:"model1",children:"Mod\xe8le 1"}),(0,t.jsx)(b.eb,{value:"model2",children:"Mod\xe8le 2"})]})]}),(0,t.jsx)(n.Button,{size:"sm",variant:"outline",className:"w-full",children:"Ajouter mod\xe8le"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.Button,{className:"flex-1",onClick:R,disabled:!k,children:"Ajouter"}),(0,t.jsx)(n.Button,{variant:"outline",className:"flex-1",children:"Annuler"})]})]})})}),(0,t.jsx)("div",{className:"lg:col-span-3",children:(0,t.jsxs)(i.Zp,{children:[(0,t.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.ZB,{className:"text-red-600",children:"Aucune date s\xe9lectionn\xe9e"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Voir mensuelle"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>{C(new Date(w.getFullYear(),w.getMonth()-1))},children:(0,t.jsx)(j.A,{className:"w-5 h-5"})}),(0,t.jsxs)("h2",{className:"text-2xl font-bold text-red-600 min-w-[120px] text-center",children:[["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"][w.getMonth()]," ",w.getFullYear()]}),(0,t.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>{C(new Date(w.getFullYear(),w.getMonth()+1))},children:(0,t.jsx)(g.A,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(f.m_,{children:[(0,t.jsx)(f.k$,{asChild:!0,children:(0,t.jsx)(n.Button,{size:"icon",variant:"ghost",children:"\uD83D\uDDA8️"})}),(0,t.jsx)(f.ZI,{children:"Imprimer"})]}),(0,t.jsxs)(f.m_,{children:[(0,t.jsx)(f.k$,{asChild:!0,children:(0,t.jsx)(n.Button,{size:"icon",variant:"ghost",children:"❓"})}),(0,t.jsx)(f.ZI,{children:"Aide"})]})]})]}),(0,t.jsxs)(i.Wu,{children:[(0,t.jsx)("div",{className:"grid grid-cols-7 gap-px mb-2",children:["lundi","mardi","mercredi","jeudi","vendredi","samedi","dimanche"].map(e=>(0,t.jsx)("div",{className:"text-center font-semibold text-sm py-2 border-b-2 border-cyan-500",children:e},e))}),(0,t.jsxs)("div",{className:"grid grid-cols-7 gap-px bg-cyan-500 p-px",children:[Z.map((e,s)=>(0,t.jsx)("div",{className:"bg-gray-50 min-h-[120px]"},"empty-".concat(s))),M.map(e=>{let s=(e=>{let s=new Date(w.getFullYear(),w.getMonth(),e);return A.filter(e=>e.date.toDateString()===s.toDateString())})(e),r=k&&k.getDate()===e&&k.getMonth()===w.getMonth()&&k.getFullYear()===w.getFullYear();return(0,t.jsxs)("div",{onClick:()=>S(new Date(w.getFullYear(),w.getMonth(),e)),className:"min-h-[120px] p-2 cursor-pointer border-2 ".concat(r?"bg-cyan-100 border-cyan-500":"bg-white border-cyan-500"," hover:bg-cyan-50"),children:[(0,t.jsx)("div",{className:"font-bold text-lg mb-2",children:e}),(0,t.jsx)("div",{className:"space-y-1 text-xs",children:s.map(e=>(0,t.jsx)("div",{className:"bg-blue-100 p-1 rounded truncate",children:e.time},e.id))})]},e)})]})]})]})})]})}):(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("p",{className:"text-lg text-muted-foreground",children:"Chargement des donn\xe9es..."})})}},46767:(e,s,r)=>{"use strict";r.d(s,{Bc:()=>n,ZI:()=>o,k$:()=>c,m_:()=>d});var t=r(95155),l=r(12115),a=r(26852),i=r(64269);let n=a.Kq,d=a.bL,c=a.l9,o=l.forwardRef((e,s)=>{let{className:r,sideOffset:l=4,...n}=e;return(0,t.jsx)(a.UC,{ref:s,sideOffset:l,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...n})});o.displayName=a.UC.displayName},65142:(e,s,r)=>{"use strict";r.d(s,{p:()=>i});var t=r(95155),l=r(12115),a=r(64269);let i=l.forwardRef((e,s)=>{let{className:r,type:l,...i}=e;return(0,t.jsx)("input",{type:l,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:ring-yellow-400/30 focus-visible:border-yellow-400",r),ref:s,...i})});i.displayName="Input"},73457:(e,s,r)=>{"use strict";r.d(s,{S:()=>d});var t=r(95155),l=r(12115),a=r(38162),i=r(72251),n=r(64269);let d=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,t.jsx)(a.bL,{ref:s,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground","accent-amber-500","data-[state=checked]:bg-amber-500 data-[state=checked]:border-amber-500",r),...l,children:(0,t.jsx)(a.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(i.A,{className:"h-4 w-4"})})})});d.displayName=a.bL.displayName},76444:(e,s,r)=>{"use strict";r.d(s,{Label:()=>c});var t=r(95155),l=r(12115),a=r(10489),i=r(83101),n=r(64269);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,t.jsx)(a.b,{ref:s,className:(0,n.cn)(d(),r),...l})});c.displayName=a.b.displayName},86948:(e,s,r)=>{"use strict";r.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>i,aR:()=>n,wL:()=>m});var t=r(95155),l=r(12115),a=r(64269);let i=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...l})});i.displayName="Card";let n=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...l})});n.displayName="CardHeader";let d=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,t.jsx)("h3",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight text-primary",r),...l})});d.displayName="CardTitle";let c=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,t.jsx)("p",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",r),...l})});c.displayName="CardDescription";let o=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",r),...l})});o.displayName="CardContent";let m=l.forwardRef((e,s)=>{let{className:r,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",r),...l})});m.displayName="CardFooter"}},e=>{e.O(0,[830,3928,5502,4733,5063,8763,7941,9325,8441,1255,7358],()=>e(e.s=28262)),_N_E=e.O()}]);