(()=>{var e={};e.id=4606,e.ids=[4606],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},90295:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>I,routeModule:()=>x,serverHooks:()=>S,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>k});var s={};t.r(s),t.d(s,{GET:()=>w,POST:()=>v});var a=t(96559),o=t(48088),n=t(37719),i=t(32190),u=t(29021),p=t(33873),c=t.n(p);let d=c().join(process.cwd(),"data","vcm-assignments.json");async function l(){try{await u.promises.mkdir(c().dirname(d),{recursive:!0});let e=await u.promises.readFile(d,"utf8");return JSON.parse(e)}catch(e){if(e instanceof Error&&"code"in e&&"ENOENT"===e.code)return{};throw e}}async function m(e){await u.promises.mkdir(c().dirname(d),{recursive:!0}),await u.promises.writeFile(d,JSON.stringify(e,null,2),"utf8")}async function w(e,{params:r}){try{let e=(await l())[r.weekStartIso]||{};return i.NextResponse.json(e)}catch(e){return i.NextResponse.json({message:"Erreur serveur",error:e.message},{status:500})}}async function v(e,{params:r}){let t=await e.json().catch(()=>({}));console.log("[API][ASSIGN]",{week:r.weekStartIso,payload:t});try{let e=await l();return e[r.weekStartIso]||(e[r.weekStartIso]={}),e[r.weekStartIso][t.itemId]={...e[r.weekStartIso][t.itemId]||{},personId:t.personId,role:t.role,override:t.override},await m(e),i.NextResponse.json({ok:!0})}catch(e){return i.NextResponse.json({message:"Erreur serveur lors de la sauvegarde",error:e.message},{status:500})}}let x=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/vcm/[weekStartIso]/assign/route",pathname:"/api/vcm/[weekStartIso]/assign",filename:"route",bundlePath:"app/api/vcm/[weekStartIso]/assign/route"},resolvedPagePath:"C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\api\\vcm\\[weekStartIso]\\assign\\route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:g,workUnitAsyncStorage:k,serverHooks:S}=x;function I(){return(0,n.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:k})}},96487:()=>{}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4447,580],()=>t(90295));module.exports=s})();