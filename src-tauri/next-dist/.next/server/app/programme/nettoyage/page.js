(()=>{var e={};e.id=4472,e.ids=[4472],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3394:(e,s,r)=>{Promise.resolve().then(r.bind(r,56488))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},23733:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>o});var t=r(65239),a=r(48088),l=r(88170),n=r.n(l),i=r(30893),c={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);r.d(s,c);let o={children:["",{children:["programme",{children:["nettoyage",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,26090)),"C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\programme\\nettoyage\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\programme\\nettoyage\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/programme/nettoyage/page",pathname:"/programme/nettoyage",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},26090:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Public\\\\Documents\\\\app-gestionnaire\\\\src\\\\app\\\\programme\\\\nettoyage\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\programme\\nettoyage\\page.tsx","default")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},56488:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>z});var t=r(60687),a=r(43210),l=r(44493),n=r(6211),i=r(15079),c=r(29523),o=r(63503),d=r(56896),u=r(89667),m=r(80013),x=r(91821),p=r(40988),h=r(26373),j=r(43967),f=r(26622),g=r(74158),v=r(57207),b=r(28946),N=r(87482),w=r(78726),y=r(54052),C=r(14283),P=r(14975),k=r(10869),M=r(1675),$=r(75699),S=r(33660),A=r(84334),G=r(41855),E=r(18360);let _=["Salle principale","Sc\xe8ne","Toilettes","Entr\xe9e et couloirs","Salles annexes","Ext\xe9rieur"],q={"Salle principale":4,Scène:2,Toilettes:2,"Entr\xe9e et couloirs":2,"Salles annexes":2,Extérieur:2},B=(e,s)=>{let r=[];for(let t=0;t<s;t++){let s=(0,k.J)(e,t),a=(0,M.$)(s,{locale:A.fr}),l=(e,s)=>{let r=(0,$.GP)(e,"MMMM",{locale:A.fr}),t=(0,$.GP)(s,"MMMM",{locale:A.fr}),a=(0,$.GP)(e,"dd",{locale:A.fr}),l=(0,$.GP)(s,"dd",{locale:A.fr});return r===t?`${r} ${a}–${l}`:`${r} ${a}–${t} ${l}`};r.push(l(s,a))}return r},D=()=>{let e=new Date,s=(0,S.k)(e,{locale:A.fr}),r=(0,M.$)(e,{locale:A.fr}),t=(0,$.GP)(s,"MMMM",{locale:A.fr}),a=(0,$.GP)(r,"MMMM",{locale:A.fr}),l=(0,$.GP)(s,"dd",{locale:A.fr}),n=(0,$.GP)(r,"dd",{locale:A.fr});return t===a?`${t} ${l}–${n}`:`${t} ${l}–${a} ${n}`},L=e=>B((0,S.k)(new Date,{locale:A.fr}),24).map(s=>({week:s,...e.reduce((e,s)=>({...e,[s]:[]}),{})}));function z(){let{people:e}=(0,E.d)(),[s,r]=(0,a.useState)(_),[o,d]=(0,a.useState)(q),[u,x]=(0,a.useState)(()=>L(_)),[y,C]=(0,a.useState)(new Date),[P,k]=(0,a.useState)(D()),B=e.map(e=>({value:e.id,label:e.displayName})),z=(0,a.useMemo)(()=>{let s={};return e.forEach(e=>{let r=e.spiritual.group||"unassigned";"unassigned"!==r&&(s[r]||(s[r]=[]),s[r].push(e))}),Object.keys(s).sort().map((e,s)=>({id:e,name:`Groupe ${s+1}`}))},[e]),R=z.map(e=>({value:e.id,label:e.name})),T=(s,r)=>{x(t=>t.map(t=>{if(t.week===P){let a;return a="Entretien"===s?r.map(e=>{let s=z.find(s=>s.id===e);return s?s.name:""}).filter(Boolean):r.map(s=>{let r=e.find(e=>e.id===s);return r?r.displayName:""}).filter(Boolean),{...t,[s]:a}}return t}))},U=e=>{r(s=>s.filter(s=>s!==e)),d(s=>{let r={...s};return delete r[e],r}),x(s=>s.map(s=>{let r={...s};return delete r[e],r}))};(0,a.useRef)(!0);let I=u.find(e=>e.week===P);return(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{children:[(0,t.jsx)(l.ZB,{children:"Organisation du Nettoyage"}),(0,t.jsx)(l.BT,{children:"Planifiez et visualisez les affectations pour le nettoyage."})]}),(0,t.jsxs)(l.Wu,{children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6 p-4 border rounded-lg bg-muted/40",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Label,{htmlFor:"week-select",className:"sr-only",children:"Semaine"}),(0,t.jsxs)(i.l6,{value:P,onValueChange:k,children:[(0,t.jsx)(i.bq,{id:"week-select",className:"w-[200px]",children:(0,t.jsx)(i.yv,{placeholder:"S\xe9lectionner une semaine"})}),(0,t.jsx)(i.gC,{children:u.map(e=>(0,t.jsx)(i.eb,{value:e.week,children:e.week},e.week))})]}),(0,t.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(j.A,{className:"h-4 w-4"})}),(0,t.jsxs)(p.AM,{children:[(0,t.jsx)(p.Wv,{asChild:!0,children:(0,t.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(f.A,{className:"h-4 w-4"})})}),(0,t.jsx)(p.hl,{className:"w-auto p-0",onInteractOutside:e=>{e.preventDefault()},children:(0,t.jsx)(h.V,{mode:"single",selected:y,onSelect:e=>{let s;if(!e)return;C(e);let r=(0,S.k)(e,{locale:A.fr}),t=(0,M.$)(e,{locale:A.fr}),a=(0,$.GP)(r,"MMMM",{locale:A.fr}),l=(0,$.GP)(t,"MMMM",{locale:A.fr}),n=(0,$.GP)(r,"dd",{locale:A.fr}),i=(0,$.GP)(t,"dd",{locale:A.fr});k(a===l?`${a} ${n}–${i}`:`${a} ${n}–${l} ${i}`)},initialFocus:!0})})]}),(0,t.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(g.A,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(F,{onAddService:(e,t)=>{let a=e.replace(/ /g,"_");if(s.includes(a))return void alert("Ce service existe d\xe9j\xe0.");r(e=>[...e,a]),d(e=>({...e,[a]:t})),x(e=>e.map(e=>({...e,[a]:[]})))}}),(0,t.jsxs)(c.Button,{variant:"outline",onClick:()=>{x(e=>e.map(e=>{if(e.week===P){let r={...e};return s.forEach(e=>{r[e]=[]}),r}return e}))},children:[(0,t.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Effacer"]}),(0,t.jsx)(O,{rolePersonCounts:o}),(0,t.jsx)(c.Button,{variant:"ghost",size:"icon",onClick:()=>window.print(),children:(0,t.jsx)(b.A,{className:"h-4 w-4"})}),(0,t.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(N.A,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4 text-red-500 text-center",children:P}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:s.map(s=>{let r,a="Entretien"===s,l=I?.[s]||[];return r=a?z.filter(e=>l.includes(e.name)).map(e=>e.id):e.filter(e=>l.includes(e.displayName)).map(e=>e.id),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(m.Label,{children:s.replace(/_/g," ")}),(0,t.jsx)(c.Button,{variant:"ghost",size:"icon",onClick:()=>U(s),children:(0,t.jsx)(w.A,{className:"h-4 w-4"})})]}),(0,t.jsx)(G.K,{options:a?R:B,selected:r,onChange:e=>T(s,e),placeholder:"S\xe9lectionner..."})]},s)})})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(n.XI,{children:[(0,t.jsx)(n.A0,{children:(0,t.jsxs)(n.Hj,{children:[(0,t.jsx)(n.nd,{className:"w-[180px]",children:"Date"}),s.map(e=>(0,t.jsx)(n.nd,{children:e.replace(/_/g," ")},e))]})}),(0,t.jsx)(n.BF,{children:u.map(e=>(0,t.jsxs)(n.Hj,{className:e.week===D()?"bg-yellow-100/70":"",children:[(0,t.jsx)(n.nA,{className:"font-medium",children:e.week}),s.map(s=>(0,t.jsx)(n.nA,{children:(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(e[s]||[]).map((e,s)=>(0,t.jsx)("span",{className:"h-6",children:e},s))})},s))]},e.week))})]})})]})]})}function F({onAddService:e}){let[s,r]=(0,a.useState)(!1),[l,n]=(0,a.useState)(""),[i,d]=(0,a.useState)(1);return(0,t.jsxs)(o.lG,{open:s,onOpenChange:r,children:[(0,t.jsx)(o.zM,{asChild:!0,children:(0,t.jsxs)(c.Button,{variant:"outline",children:[(0,t.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Ajouter une t\xe2che"]})}),(0,t.jsxs)(o.Cf,{className:"sm:max-w-[425px]",children:[(0,t.jsx)(o.c7,{children:(0,t.jsx)(o.L3,{children:"Ajouter une nouvelle t\xe2che"})}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.Label,{htmlFor:"role-name",className:"text-right",children:"Nom"}),(0,t.jsx)(u.p,{id:"role-name",value:l,onChange:e=>n(e.target.value),className:"col-span-3",placeholder:"Ex: Entretien"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(m.Label,{htmlFor:"person-count",className:"text-right",children:"Personnes"}),(0,t.jsx)(u.p,{id:"person-count",type:"number",value:i,onChange:e=>d(parseInt(e.target.value,10)||1),className:"col-span-3",min:"1"})]})]}),(0,t.jsx)(o.Es,{children:(0,t.jsx)(c.Button,{onClick:()=>{l.trim()&&(e(l.trim(),i),n(""),d(1),r(!1))},children:"Ajouter la t\xe2che"})})]})]})}function O({rolePersonCounts:e}){let[s,r]=(0,a.useState)(!1);return(0,t.jsxs)(o.lG,{open:s,onOpenChange:r,children:[(0,t.jsx)(o.zM,{asChild:!0,children:(0,t.jsxs)(c.Button,{variant:"outline",children:[(0,t.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Saisie automatique"]})}),(0,t.jsxs)(o.Cf,{className:"sm:max-w-[600px]",children:[(0,t.jsx)(o.c7,{children:(0,t.jsx)(o.L3,{children:"Param\xe8tres de la saisie automatique"})}),(0,t.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(m.Label,{className:"font-semibold",children:"Choisir les t\xe2ches et le nombre de personnes"}),Object.entries(e).map(([e,s])=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(m.Label,{htmlFor:e,className:"flex-1",children:e.replace(/_/g," ")}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:[...Array(s)].map((s,r)=>(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(d.S,{id:`${e}-${r+1}`}),(0,t.jsx)(m.Label,{htmlFor:`${e}-${r+1}`,className:"text-sm font-normal",children:r+1})]},r))})]},e))]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(m.Label,{htmlFor:"weeks-count",children:"Semaines pour l'attribution"}),(0,t.jsxs)(i.l6,{children:[(0,t.jsx)(i.bq,{id:"weeks-count",children:(0,t.jsx)(i.yv,{placeholder:"Nombre de semaines"})}),(0,t.jsx)(i.gC,{children:[2,3,4,5,6,7,8].map(e=>(0,t.jsxs)(i.eb,{value:String(e),children:[e," semaines"]},e))})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(m.Label,{htmlFor:"attribution-criteria",children:"Command\xe9 par"}),(0,t.jsxs)(i.l6,{children:[(0,t.jsx)(i.bq,{id:"attribution-criteria",children:(0,t.jsx)(i.yv,{placeholder:"Crit\xe8re d'attribution"})}),(0,t.jsxs)(i.gC,{children:[(0,t.jsx)(i.eb,{value:"recent",children:"Service r\xe9cent"}),(0,t.jsx)(i.eb,{value:"rotation",children:"Rotation"}),(0,t.jsx)(i.eb,{value:"random",children:"Al\xe9atoire"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,t.jsx)(d.S,{id:"check-existing",defaultChecked:!0}),(0,t.jsx)(m.Label,{htmlFor:"check-existing",className:"font-normal",children:"V\xe9rifier l’attribution existante"})]}),(0,t.jsxs)(x.Fc,{variant:"destructive",className:"mt-4",children:[(0,t.jsx)(P.A,{className:"h-4 w-4"}),(0,t.jsx)(x.TN,{children:"Cette action va \xe9craser toutes les futures affectations pour les r\xf4les et semaines s\xe9lectionn\xe9s."})]})]}),(0,t.jsxs)(o.Es,{children:[(0,t.jsx)(o.HM,{asChild:!0,children:(0,t.jsx)(c.Button,{type:"button",variant:"secondary",children:"❌ Annuler"})}),(0,t.jsx)(c.Button,{type:"button",onClick:()=>{console.log("Lancement de la saisie automatique..."),r(!1),alert("Saisie automatique effectu\xe9e (simulation) !")},children:"\uD83D\uDFE6 Saisie automatique"})]})]})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63226:(e,s,r)=>{Promise.resolve().then(r.bind(r,26090))},79551:e=>{"use strict";e.exports=require("url")}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[4447,8736,1658,4591,7975,1265,4394,8617,4655,99,4645,9857],()=>r(23733));module.exports=t})();