(()=>{var e={};e.id=6696,e.ids=[6696],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11056:(e,s,r)=>{Promise.resolve().then(r.bind(r,91960))},15810:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>z});var a=r(60687),t=r(43210),i=r(44493),n=r(6211),l=r(15079),c=r(29523),o=r(63503),d=r(56896),m=r(89667),u=r(80013),p=r(91821),x=r(40988),h=r(26373),j=r(43967),f=r(26622),v=r(74158),g=r(57207),b=r(28946),N=r(87482),w=r(78726),C=r(54052),P=r(14283),M=r(14975),A=r(10869),k=r(1675),y=r(75699),$=r(33660),S=r(84334),G=r(41855),_=r(18360);let E=["Comptage_Assistance","Accueil \xe0 la porte","Sonorisation","Micros baladeur","Micros Estrade","Sanitaire","Accueil dans la salle","Accueil \xe0 la grande porte","Entretien"],q={Comptage_Assistance:2,"Accueil \xe0 la porte":2,Sonorisation:2,"Micros baladeur":4,"Micros Estrade":2,Sanitaire:2,"Accueil dans la salle":2,"Accueil \xe0 la grande porte":2,Entretien:1},B=(e,s)=>{let r=[];for(let a=0;a<s;a++){let s=(0,A.J)(e,a),t=(0,k.$)(s,{locale:S.fr}),i=(e,s)=>{let r=(0,y.GP)(e,"MMMM",{locale:S.fr}),a=(0,y.GP)(s,"MMMM",{locale:S.fr}),t=(0,y.GP)(e,"dd",{locale:S.fr}),i=(0,y.GP)(s,"dd",{locale:S.fr});return r===a?`${r} ${t}–${i}`:`${r} ${t}–${a} ${i}`};r.push(i(s,t))}return r},D=()=>{let e=new Date,s=(0,$.k)(e,{locale:S.fr}),r=(0,k.$)(e,{locale:S.fr}),a=(0,y.GP)(s,"MMMM",{locale:S.fr}),t=(0,y.GP)(r,"MMMM",{locale:S.fr}),i=(0,y.GP)(s,"dd",{locale:S.fr}),n=(0,y.GP)(r,"dd",{locale:S.fr});return a===t?`${a} ${i}–${n}`:`${a} ${i}–${t} ${n}`},L=e=>B((0,$.k)(new Date,{locale:S.fr}),24).map(s=>({week:s,...e.reduce((e,s)=>({...e,[s]:[]}),{})}));function z(){let{people:e}=(0,_.d)(),[s,r]=(0,t.useState)(E),[o,d]=(0,t.useState)(q),[m,p]=(0,t.useState)(()=>L(E)),[C,P]=(0,t.useState)(new Date),[M,A]=(0,t.useState)(D()),B=e.map(e=>({value:e.id,label:e.displayName})),z=(0,t.useMemo)(()=>{let s={};return e.forEach(e=>{let r=e.spiritual.group||"unassigned";"unassigned"!==r&&(s[r]||(s[r]=[]),s[r].push(e))}),Object.keys(s).sort().map((e,s)=>({id:e,name:`Groupe ${s+1}`}))},[e]),R=z.map(e=>({value:e.id,label:e.name})),U=(s,r)=>{p(a=>a.map(a=>{if(a.week===M){let t;return t="Entretien"===s?r.map(e=>{let s=z.find(s=>s.id===e);return s?s.name:""}).filter(Boolean):r.map(s=>{let r=e.find(e=>e.id===s);return r?r.displayName:""}).filter(Boolean),{...a,[s]:t}}return a}))},H=e=>{r(s=>s.filter(s=>s!==e)),d(s=>{let r={...s};return delete r[e],r}),p(s=>s.map(s=>{let r={...s};return delete r[e],r}))};(0,t.useRef)(!0);let I=m.find(e=>e.week===M);return(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{className:"no-print",children:[(0,a.jsx)(i.ZB,{children:"Organisation Hebdomadaire des Affectations de Service"}),(0,a.jsx)(i.BT,{children:"Planifiez et visualisez les affectations de service pour chaque semaine."})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6 p-4 border rounded-lg bg-muted/40 no-print",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Label,{htmlFor:"week-select",className:"sr-only",children:"Semaine"}),(0,a.jsxs)(l.l6,{value:M,onValueChange:A,children:[(0,a.jsx)(l.bq,{id:"week-select",className:"w-[200px]",children:(0,a.jsx)(l.yv,{placeholder:"S\xe9lectionner une semaine"})}),(0,a.jsx)(l.gC,{children:m.map(e=>(0,a.jsx)(l.eb,{value:e.week,children:e.week},e.week))})]}),(0,a.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(j.A,{className:"h-4 w-4"})}),(0,a.jsxs)(x.AM,{children:[(0,a.jsx)(x.Wv,{asChild:!0,children:(0,a.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})}),(0,a.jsx)(x.hl,{className:"w-auto p-0",onInteractOutside:e=>{e.preventDefault()},children:(0,a.jsx)(h.V,{mode:"single",selected:C,onSelect:e=>{let s;if(!e)return;P(e);let r=(0,$.k)(e,{locale:S.fr}),a=(0,k.$)(e,{locale:S.fr}),t=(0,y.GP)(r,"MMMM",{locale:S.fr}),i=(0,y.GP)(a,"MMMM",{locale:S.fr}),n=(0,y.GP)(r,"dd",{locale:S.fr}),l=(0,y.GP)(a,"dd",{locale:S.fr});A(t===i?`${t} ${n}–${l}`:`${t} ${n}–${i} ${l}`)},initialFocus:!0})})]}),(0,a.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(F,{onAddService:(e,a)=>{let t=e.replace(/ /g,"_");if(s.includes(t))return void alert("Ce service existe d\xe9j\xe0.");r(e=>[...e,t]),d(e=>({...e,[t]:a})),p(e=>e.map(e=>({...e,[t]:[]})))}}),(0,a.jsxs)(c.Button,{variant:"outline",onClick:()=>{p(e=>e.map(e=>{if(e.week===M){let r={...e};return s.forEach(e=>{r[e]=[]}),r}return e}))},children:[(0,a.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Effacer"]}),(0,a.jsx)(O,{rolePersonCounts:o}),(0,a.jsx)(c.Button,{variant:"ghost",size:"icon",onClick:()=>{window.print()},children:(0,a.jsx)(b.A,{className:"h-4 w-4"})}),(0,a.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(N.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"mb-8 no-print",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-red-500 text-center",children:M}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:s.map(s=>{let r,t="Entretien"===s,i=I?.[s]||[];return r=t?z.filter(e=>i.includes(e.name)).map(e=>e.id):e.filter(e=>i.includes(e.displayName)).map(e=>e.id),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(u.Label,{children:s.replace(/_/g," ")}),(0,a.jsx)(c.Button,{variant:"ghost",size:"icon",onClick:()=>H(s),children:(0,a.jsx)(w.A,{className:"h-4 w-4"})})]}),(0,a.jsx)(G.K,{options:t?R:B,selected:r,onChange:e=>U(s,e),placeholder:"S\xe9lectionner..."})]},s)})})]}),(0,a.jsxs)("div",{className:"overflow-x-auto printable-area",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4 text-center print-only hidden",children:`Programme des services - Semaine du ${M}`}),(0,a.jsxs)(n.XI,{children:[(0,a.jsx)(n.A0,{children:(0,a.jsxs)(n.Hj,{children:[(0,a.jsx)(n.nd,{className:"w-[180px]",children:"Date"}),s.map(e=>(0,a.jsx)(n.nd,{children:e.replace(/_/g," ")},e))]})}),(0,a.jsx)(n.BF,{children:m.map(e=>(0,a.jsxs)(n.Hj,{className:e.week===D()?"bg-yellow-100/70":"",children:[(0,a.jsx)(n.nA,{className:"font-medium",children:e.week}),s.map(s=>(0,a.jsx)(n.nA,{children:(0,a.jsx)("div",{className:"flex flex-col gap-1",children:(e[s]||[]).map((e,s)=>(0,a.jsx)("span",{className:"h-6",children:e},s))})},s))]},e.week))})]})]})]})]})}function F({onAddService:e}){let[s,r]=(0,t.useState)(!1),[i,n]=(0,t.useState)(""),[l,d]=(0,t.useState)(1);return(0,a.jsxs)(o.lG,{open:s,onOpenChange:r,children:[(0,a.jsx)(o.zM,{asChild:!0,children:(0,a.jsxs)(c.Button,{variant:"outline",children:[(0,a.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Ajouter un service"]})}),(0,a.jsxs)(o.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsx)(o.c7,{children:(0,a.jsx)(o.L3,{children:"Ajouter un nouveau service"})}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(u.Label,{htmlFor:"role-name",className:"text-right",children:"Nom"}),(0,a.jsx)(m.p,{id:"role-name",value:i,onChange:e=>n(e.target.value),className:"col-span-3",placeholder:"Ex: Entretien"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(u.Label,{htmlFor:"person-count",className:"text-right",children:"Personnes"}),(0,a.jsx)(m.p,{id:"person-count",type:"number",value:l,onChange:e=>d(parseInt(e.target.value,10)||1),className:"col-span-3",min:"1"})]})]}),(0,a.jsx)(o.Es,{children:(0,a.jsx)(c.Button,{onClick:()=>{i.trim()&&(e(i.trim(),l),n(""),d(1),r(!1))},children:"Ajouter le service"})})]})]})}function O({rolePersonCounts:e}){let[s,r]=(0,t.useState)(!1);return(0,a.jsxs)(o.lG,{open:s,onOpenChange:r,children:[(0,a.jsx)(o.zM,{asChild:!0,children:(0,a.jsxs)(c.Button,{variant:"outline",children:[(0,a.jsx)(P.A,{className:"mr-2 h-4 w-4"}),"Saisie automatique"]})}),(0,a.jsxs)(o.Cf,{className:"sm:max-w-[600px]",children:[(0,a.jsx)(o.c7,{children:(0,a.jsx)(o.L3,{children:"Param\xe8tres de la saisie automatique"})}),(0,a.jsxs)("div",{className:"grid gap-6 py-4 max-h-[60vh] overflow-y-auto pr-4",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(u.Label,{className:"font-semibold",children:"Choisir les r\xf4les et le nombre de personnes"}),Object.entries(e).map(([e,s])=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(u.Label,{htmlFor:e,className:"flex-1",children:e.replace(/_/g," ")}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:[...Array(s)].map((s,r)=>(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(d.S,{id:`${e}-${r+1}`}),(0,a.jsx)(u.Label,{htmlFor:`${e}-${r+1}`,className:"text-sm font-normal",children:r+1})]},r))})]},e))]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(u.Label,{htmlFor:"weeks-count",children:"Semaines pour l'attribution"}),(0,a.jsxs)(l.l6,{children:[(0,a.jsx)(l.bq,{id:"weeks-count",children:(0,a.jsx)(l.yv,{placeholder:"Nombre de semaines"})}),(0,a.jsx)(l.gC,{children:[2,3,4,5,6,7,8].map(e=>(0,a.jsxs)(l.eb,{value:String(e),children:[e," semaines"]},e))})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(u.Label,{htmlFor:"attribution-criteria",children:"Command\xe9 par"}),(0,a.jsxs)(l.l6,{children:[(0,a.jsx)(l.bq,{id:"attribution-criteria",children:(0,a.jsx)(l.yv,{placeholder:"Crit\xe8re d'attribution"})}),(0,a.jsxs)(l.gC,{children:[(0,a.jsx)(l.eb,{value:"recent",children:"Service r\xe9cent"}),(0,a.jsx)(l.eb,{value:"rotation",children:"Rotation"}),(0,a.jsx)(l.eb,{value:"random",children:"Al\xe9atoire"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,a.jsx)(d.S,{id:"check-existing",defaultChecked:!0}),(0,a.jsx)(u.Label,{htmlFor:"check-existing",className:"font-normal",children:"V\xe9rifier l’attribution existante"})]}),(0,a.jsxs)(p.Fc,{variant:"destructive",className:"mt-4",children:[(0,a.jsx)(M.A,{className:"h-4 w-4"}),(0,a.jsx)(p.TN,{children:"Cette action va \xe9craser toutes les futures affectations pour les r\xf4les et semaines s\xe9lectionn\xe9s."})]})]}),(0,a.jsxs)(o.Es,{children:[(0,a.jsx)(o.HM,{asChild:!0,children:(0,a.jsx)(c.Button,{type:"button",variant:"secondary",children:"❌ Annuler"})}),(0,a.jsx)(c.Button,{type:"button",onClick:()=>{console.log("Lancement de la saisie automatique..."),r(!1),alert("Saisie automatique effectu\xe9e (simulation) !")},children:"\uD83D\uDFE6 Saisie automatique"})]})]})]})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},45904:(e,s,r)=>{Promise.resolve().then(r.bind(r,15810))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79551:e=>{"use strict";e.exports=require("url")},85311:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>o});var a=r(65239),t=r(48088),i=r(88170),n=r.n(i),l=r(30893),c={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);r.d(s,c);let o={children:["",{children:["programme",{children:["services",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,91960)),"C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\programme\\services\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\programme\\services\\page.tsx"],m={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:t.RouteKind.APP_PAGE,page:"/programme/services/page",pathname:"/programme/services",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},91960:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Public\\\\Documents\\\\app-gestionnaire\\\\src\\\\app\\\\programme\\\\services\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Public\\Documents\\app-gestionnaire\\src\\app\\programme\\services\\page.tsx","default")}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),a=s.X(0,[4447,8736,1658,4591,7975,1265,4394,8617,4655,99,4645,9857],()=>r(85311));module.exports=a})();