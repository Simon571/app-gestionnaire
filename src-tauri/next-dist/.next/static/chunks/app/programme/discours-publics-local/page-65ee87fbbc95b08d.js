(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9423],{11373:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>z});var l=r(95155),t=r(12115),a=r(30285),n=r(66695),i=r(62523),d=r(85057),c=r(85127),o=r(59409),u=r(47262),h=r(66424),x=r(18046),m=r(77223),p=r(77381),j=r(79556),f=r(18763),g=r(75074),b=r(19637),N=r(18018),v=r(76603),w=r(50286),y=r(51920),A=r(32714),k=r(24386),C=r(41784),L=r(16946),S=r(87481),D=r(59434),M=r(54165);let _=()=>{let e=[],s=new Date;for(let r=0;r<52;r++)e.push({id:r,date:new Date(s),orateur:null,assemblee:"",discours:"",isExternal:!1,isCancelled:!1,president:null,lecteur:null,priere:null,orateur2:null,hospitalite:null}),s.setDate(s.getDate()+7);return e},B=e=>{let{people:s,assignment:r,value:a,onValueChange:n,allSchedules:i,currentWeekDate:d,selectedWeek:c}=e,u=(e,s)=>{var r,l;if(!e.assignments)return!1;let t={orateur:"weekendMeeting.localSpeaker",president:"weekendMeeting.president",lecteur:"weekendMeeting.wtReader",priere:"weekendMeeting.finalPrayer",orateur2:"weekendMeeting.orateur2",hospitalite:"weekendMeeting.hospitality"}[s];if(!t)return!1;let[a,n]=t.split(".");return null==(l=e.assignments)||null==(r=l[a])?void 0:r[n]},x=(e,s)=>{let r=null;return i.forEach(l=>{if(l.date>=d)return;let t=!1;switch(s){case"orateur":t=l.orateur===e;break;case"president":t=l.president===e;break;case"lecteur":t=l.lecteur===e;break;case"priere":t=l.priere===e;break;case"orateur2":t=l.orateur2===e;break;case"hospitalite":t=l.hospitalite===e}t&&(!r||l.date>r)&&(r=l.date)}),r},m=t.useMemo(()=>{let e=new Date,l=s.filter(e=>u(e,r)).map(s=>{let l=x(s.id,r);return{...s,lastAssignmentDate:l,daysSinceLastAssignment:l?(0,k.c)(e,l):1/0}}).sort((e,s)=>s.daysSinceLastAssignment-e.daysSinceLastAssignment);return 0===l.length?[{id:"aucun-qualifie",displayName:"Aucune personne qualifi\xe9e",lastAssignmentDate:null,daysSinceLastAssignment:0}]:l},[s,r,i,d]),p=t.useMemo(()=>!!a&&[c.orateur,c.president,c.lecteur,c.priere,c.orateur2].filter(e=>e===a).length>1,[c,a]);return(0,l.jsxs)(o.l6,{value:a||"aucun",onValueChange:e=>n("aucun"===e?void 0:e),children:[(0,l.jsx)(o.bq,{className:(0,D.cn)("bg-white h-8 w-full",{"border-red-500 ring-2 ring-red-500":p}),children:(0,l.jsx)(o.yv,{placeholder:"S\xe9lectionner"})}),(0,l.jsx)(o.gC,{children:(0,l.jsxs)(h.F,{className:"h-[40vh]",children:[(0,l.jsx)(o.eb,{value:"aucun",children:"Aucun"}),m.map(e=>(0,l.jsxs)(o.eb,{value:e.id,disabled:"aucun-qualifie"===e.id,children:[e.displayName,e.lastAssignmentDate?(0,l.jsxs)("span",{className:"text-muted-foreground ml-2 text-xs",children:["- ",(0,C.GP)(e.lastAssignmentDate,"dd/MM/yy",{locale:L.fr})]}):"aucun-qualifie"!==e.id&&(0,l.jsx)("span",{className:"text-muted-foreground ml-2 text-xs",children:"- Jamais"})]},e.id))]})})]})},F=e=>{let{value:s,onValueChange:r,allSchedules:a,currentWeekDate:n}=e,{families:i}=(0,A.d)(),d=e=>{let s=null;return a.forEach(r=>{r.date>=n||r.hospitalite===e&&(!s||r.date>s)&&(s=r.date)}),s},c=t.useMemo(()=>{let e=new Date;return i.map(s=>{let r=d(s.id);return{...s,lastAssignmentDate:r,daysSinceLastAssignment:r?(0,k.c)(e,r):1/0}}).sort((e,s)=>s.daysSinceLastAssignment-e.daysSinceLastAssignment)},[i,a,n]);return(0,l.jsxs)(o.l6,{value:s||"aucune",onValueChange:e=>r("aucune"===e?void 0:e),children:[(0,l.jsx)(o.bq,{className:"bg-white h-8 w-full",children:(0,l.jsx)(o.yv,{placeholder:"S\xe9lectionner une famille"})}),(0,l.jsx)(o.gC,{children:(0,l.jsxs)(h.F,{className:"h-[40vh]",children:[(0,l.jsx)(o.eb,{value:"aucune",children:"Aucune"}),c.map(e=>(0,l.jsxs)(o.eb,{value:e.id,children:[e.name,e.lastAssignmentDate?(0,l.jsxs)("span",{className:"text-muted-foreground ml-2 text-xs",children:["- ",(0,C.GP)(e.lastAssignmentDate,"dd/MM/yy",{locale:L.fr})]}):(0,l.jsx)("span",{className:"text-muted-foreground ml-2 text-xs",children:"- Jamais"})]},e.id))]})})]})},R=e=>{let{discourseList:s,onUpdate:r}=e,[n,d]=t.useState(s),[o,u]=t.useState(""),[p,j]=t.useState(""),f=e=>{d(n.filter(s=>s.number!==e))};return(0,l.jsxs)(M.Cf,{className:"max-w-3xl",children:[(0,l.jsx)(M.c7,{children:(0,l.jsx)(M.L3,{children:"G\xe9rer la liste des discours"})}),(0,l.jsxs)("div",{className:"grid grid-cols-[80px_1fr_auto] gap-2 items-center my-4",children:[(0,l.jsx)(i.p,{placeholder:"N\xb0",value:o,onChange:e=>u(e.target.value),type:"number"}),(0,l.jsx)(i.p,{placeholder:"Titre du discours",value:p,onChange:e=>j(e.target.value)}),(0,l.jsx)(a.Button,{onClick:()=>{o&&p&&(d([...n,{number:parseInt(o),title:p}]),u(""),j(""))},size:"icon",children:(0,l.jsx)(x.A,{})})]}),(0,l.jsx)(h.F,{className:"h-96 border rounded-md",children:(0,l.jsxs)(c.XI,{children:[(0,l.jsx)(c.A0,{children:(0,l.jsxs)(c.Hj,{children:[(0,l.jsx)(c.nd,{className:"w-24",children:"Num\xe9ro"}),(0,l.jsx)(c.nd,{children:"Titre"}),(0,l.jsx)(c.nd,{className:"w-20"})]})}),(0,l.jsx)(c.BF,{children:n.sort((e,s)=>e.number-s.number).map(e=>(0,l.jsxs)(c.Hj,{children:[(0,l.jsx)(c.nA,{children:e.number}),(0,l.jsx)(c.nA,{children:e.title}),(0,l.jsx)(c.nA,{children:(0,l.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>f(e.number),children:(0,l.jsx)(m.A,{className:"h-4 w-4 text-red-500"})})})]},e.number))})]})}),(0,l.jsx)(M.Es,{children:(0,l.jsx)(a.Button,{onClick:()=>{r(n)},children:"Sauvegarder les modifications"})})]})};function z(){let{people:e,discourseList:s,updateDiscourseList:r}=(0,A.d)(),[x,m]=t.useState(_),[C,L]=t.useState(0),{toast:z}=(0,S.dj)(),T=x[C],W=(e,s)=>{let r=[...x];r[C][e]=s,m(r),z({description:"Modification enregistr\xe9e."})},V=e=>{L(e)},H=e=>{"up"===e&&C>0?L(C-1):"down"===e&&C<x.length-1&&L(C+1)};return(0,l.jsxs)(n.Zp,{className:"h-full flex flex-col",children:[(0,l.jsxs)(n.aR,{className:"p-4 space-y-4 no-print",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-primary",children:"Discours publics - Local"}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>H("up"),children:(0,l.jsx)(p.A,{className:"h-5 w-5"})}),(0,l.jsx)("span",{className:"font-bold text-red-600 text-lg",children:T.date.toLocaleDateString("fr-CA")}),(0,l.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>H("down"),children:(0,l.jsx)(j.A,{className:"h-5 w-5"})})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4 text-sm",children:[(0,l.jsxs)("div",{className:"space-y-2 col-span-1 lg:col-span-2",children:[(0,l.jsxs)("div",{className:"grid grid-cols-[80px_1fr] items-center gap-2",children:[(0,l.jsx)(d.Label,{htmlFor:"orateur",children:"Orateur"}),(0,l.jsx)(B,{people:e,assignment:"orateur",value:T.orateur,onValueChange:e=>W("orateur",e),allSchedules:x,currentWeekDate:T.date,selectedWeek:T})]}),(0,l.jsxs)("div",{className:"grid grid-cols-[80px_1fr_auto] items-center gap-2",children:[(0,l.jsx)(d.Label,{htmlFor:"discours",children:"Discours"}),(0,l.jsxs)(o.l6,{value:T.discours,onValueChange:e=>W("discours",e),children:[(0,l.jsx)(o.bq,{id:"discours",className:"h-8 bg-white",children:(0,l.jsx)(o.yv,{placeholder:"S\xe9lectionner un discours"})}),(0,l.jsx)(o.gC,{children:(0,l.jsx)(h.F,{className:"h-[40vh]",children:s.map(e=>(0,l.jsxs)(o.eb,{value:e.number.toString(),disabled:e.title.includes("(Ne pas utiliser)"),children:[e.number,". ",e.title]},e.number))})})]}),(0,l.jsxs)(M.lG,{children:[(0,l.jsx)(M.zM,{asChild:!0,children:(0,l.jsx)(a.Button,{variant:"ghost",size:"icon",children:(0,l.jsx)(f.A,{className:"h-4 w-4"})})}),(0,l.jsx)(R,{discourseList:s,onUpdate:r})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-[80px_1fr] items-center gap-2",children:[(0,l.jsx)(d.Label,{htmlFor:"notes",children:"Notes"}),(0,l.jsx)(i.p,{id:"notes",className:"h-8 bg-white"})]})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"grid grid-cols-[120px_1fr] items-center gap-2",children:[(0,l.jsx)(d.Label,{htmlFor:"president",children:"Pr\xe9sident"}),(0,l.jsx)(B,{people:e,assignment:"president",value:T.president,onValueChange:e=>W("president",e),allSchedules:x,currentWeekDate:T.date,selectedWeek:T})]}),(0,l.jsxs)("div",{className:"grid grid-cols-[120px_1fr] items-center gap-2",children:[(0,l.jsx)(d.Label,{htmlFor:"lecteur",children:"Lecteur Tour de Garde"}),(0,l.jsx)(B,{people:e,assignment:"lecteur",value:T.lecteur,onValueChange:e=>W("lecteur",e),allSchedules:x,currentWeekDate:T.date,selectedWeek:T})]}),(0,l.jsxs)("div",{className:"grid grid-cols-[120px_1fr] items-center gap-2",children:[(0,l.jsx)(d.Label,{htmlFor:"priere",children:"Pri\xe8re de fin"}),(0,l.jsx)(B,{people:e,assignment:"priere",value:T.priere,onValueChange:e=>W("priere",e),allSchedules:x,currentWeekDate:T.date,selectedWeek:T})]}),(0,l.jsxs)("div",{className:"grid grid-cols-[120px_1fr] items-center gap-2",children:[(0,l.jsx)(d.Label,{htmlFor:"orateur2",children:"Orateur 2"}),(0,l.jsx)(B,{people:e,assignment:"orateur2",value:T.orateur2,onValueChange:e=>W("orateur2",e),allSchedules:x,currentWeekDate:T.date,selectedWeek:T})]}),(0,l.jsxs)("div",{className:"grid grid-cols-[120px_1fr] items-center gap-2",children:[(0,l.jsx)(d.Label,{htmlFor:"hospitalite",children:"Hospitalit\xe9"}),(0,l.jsx)(F,{value:T.hospitalite,onValueChange:e=>W("hospitalite",e),allSchedules:x,currentWeekDate:T.date})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 pt-2 border-t",children:[(0,l.jsx)(a.Button,{variant:"outline",size:"icon",onClick:()=>z({title:"Bient\xf4t disponible",description:"La fonction de recherche sera bient\xf4t ajout\xe9e."}),children:(0,l.jsx)(g.A,{className:"h-4 w-4"})}),(0,l.jsx)(a.Button,{variant:"outline",size:"icon",onClick:()=>z({title:"Bient\xf4t disponible",description:"L'envoi par e-mail sera bient\xf4t disponible."}),children:(0,l.jsx)(b.A,{className:"h-4 w-4"})}),(0,l.jsx)(a.Button,{variant:"outline",size:"icon",onClick:()=>{window.print()},children:(0,l.jsx)(N.A,{className:"h-4 w-4"})}),(0,l.jsx)(a.Button,{variant:"outline",size:"icon",onClick:()=>{let e=[...x],s=e[C];s.orateur=null,s.discours="",s.president=null,s.lecteur=null,s.priere=null,s.orateur2=null,s.hospitalite=null,s.isCancelled=!0,m(e),z({title:"Programme annul\xe9",description:"Le programme du ".concat(s.date.toLocaleDateString("fr-CA")," a \xe9t\xe9 annul\xe9."),variant:"destructive"})},children:(0,l.jsx)(v.A,{className:"h-4 w-4"})}),(0,l.jsx)(a.Button,{variant:"outline",size:"icon",onClick:()=>window.location.href="/personnes",children:(0,l.jsx)(w.A,{className:"h-4 w-4"})}),(0,l.jsx)(a.Button,{variant:"outline",size:"icon",onClick:()=>{let e=new Date;L(x.reduce((s,r,l)=>Math.abs((0,k.c)(r.date,e))<Math.abs((0,k.c)(x[s].date,e))?l:s,0)),z({description:"Affichage de la semaine en cours."})},children:(0,l.jsx)(y.A,{className:"h-4 w-4"})})]})]}),(0,l.jsx)(n.Wu,{className:"flex-grow p-0 overflow-hidden",children:(0,l.jsxs)("div",{className:"printable-area h-full",children:[(0,l.jsx)("div",{className:"print-only hidden my-4",children:(0,l.jsx)("h2",{className:"text-xl font-bold text-center",children:"Discours publics - Local"})}),(0,l.jsx)(h.F,{className:"h-full",children:(0,l.jsxs)(c.XI,{children:[(0,l.jsx)(c.A0,{className:"sticky top-0 bg-muted",children:(0,l.jsxs)(c.Hj,{children:[(0,l.jsx)(c.nd,{className:"w-[100px]",children:"Date"}),(0,l.jsx)(c.nd,{children:"Orateur"}),(0,l.jsx)(c.nd,{children:"Assembl\xe9e"}),(0,l.jsx)(c.nd,{children:"Discours public"}),(0,l.jsx)(c.nd,{className:"w-8 p-1 text-center no-print",children:(0,l.jsx)(u.S,{})}),(0,l.jsx)(c.nd,{children:"Pr\xe9sident"}),(0,l.jsx)(c.nd,{children:"Lecteur Tour de G"}),(0,l.jsx)(c.nd,{children:"Pri\xe8re de fin"}),(0,l.jsx)(c.nd,{children:"Orateur 2"}),(0,l.jsx)(c.nd,{children:"Hospitalit\xe9"})]})}),(0,l.jsx)(c.BF,{children:x.map((r,t)=>{var a;let n=e.find(e=>e.id===r.orateur),i=e.find(e=>e.id===r.president),d=e.find(e=>e.id===r.lecteur),o=e.find(e=>e.id===r.priere),h=e.find(e=>e.id===r.orateur2),{families:x}=(0,A.d)(),m=x.find(e=>e.id===r.hospitalite),p=(null==(a=s.find(e=>e.number.toString()===r.discours))?void 0:a.title)||"";return(0,l.jsxs)(c.Hj,{onClick:()=>V(t),className:(0,D.cn)("cursor-pointer",C===t&&"bg-accent"),children:[(0,l.jsx)(c.nA,{children:r.date.toLocaleDateString("fr-CA").replace(/-/g,"/")}),(0,l.jsx)(c.nA,{children:(null==n?void 0:n.displayName)||""}),(0,l.jsx)(c.nA,{children:r.assemblee}),(0,l.jsx)(c.nA,{children:p}),(0,l.jsx)(c.nA,{className:"p-1 text-center no-print",children:(0,l.jsx)(u.S,{})}),(0,l.jsx)(c.nA,{children:(null==i?void 0:i.displayName)||""}),(0,l.jsx)(c.nA,{children:(null==d?void 0:d.displayName)||""}),(0,l.jsx)(c.nA,{children:(null==o?void 0:o.displayName)||""}),(0,l.jsx)(c.nA,{children:(null==h?void 0:h.displayName)||""}),(0,l.jsx)(c.nA,{children:(null==m?void 0:m.name)||""})]},r.id)})})]})})]})})]})}},47262:(e,s,r)=>{"use strict";r.d(s,{S:()=>d});var l=r(95155),t=r(12115),a=r(76981),n=r(10518),i=r(59434);let d=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)(a.bL,{ref:s,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground","accent-amber-500","data-[state=checked]:bg-amber-500 data-[state=checked]:border-amber-500",r),...t,children:(0,l.jsx)(a.C1,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,l.jsx)(n.A,{className:"h-4 w-4"})})})});d.displayName=a.bL.displayName},66424:(e,s,r)=>{"use strict";r.d(s,{F:()=>i});var l=r(95155),t=r(12115),a=r(47655),n=r(59434);let i=t.forwardRef((e,s)=>{let{className:r,children:t,...i}=e;return(0,l.jsxs)(a.bL,{ref:s,className:(0,n.cn)("relative overflow-hidden",r),...i,children:[(0,l.jsx)(a.LM,{className:"h-full w-full rounded-[inherit]",children:t}),(0,l.jsx)(d,{}),(0,l.jsx)(a.OK,{})]})});i.displayName=a.bL.displayName;let d=t.forwardRef((e,s)=>{let{className:r,orientation:t="vertical",...i}=e;return(0,l.jsx)(a.VM,{ref:s,orientation:t,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...i,children:(0,l.jsx)(a.lr,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=a.VM.displayName},85127:(e,s,r)=>{"use strict";r.d(s,{A0:()=>i,BF:()=>d,Hj:()=>c,XI:()=>n,nA:()=>u,nd:()=>o});var l=r(95155),t=r(12115),a=r(59434);let n=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:s,className:(0,a.cn)("w-full caption-bottom text-sm",r),...t})})});n.displayName="Table";let i=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)("thead",{ref:s,className:(0,a.cn)("[&_tr]:border-b",r),...t})});i.displayName="TableHeader";let d=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)("tbody",{ref:s,className:(0,a.cn)("[&_tr:last-child]:border-0",r),...t})});d.displayName="TableBody",t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)("tfoot",{ref:s,className:(0,a.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...t})}).displayName="TableFooter";let c=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)("tr",{ref:s,className:(0,a.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...t})});c.displayName="TableRow";let o=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)("th",{ref:s,className:(0,a.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...t})});o.displayName="TableHead";let u=t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)("td",{ref:s,className:(0,a.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...t})});u.displayName="TableCell",t.forwardRef((e,s)=>{let{className:r,...t}=e;return(0,l.jsx)("caption",{ref:s,className:(0,a.cn)("mt-4 text-sm text-muted-foreground",r),...t})}).displayName="TableCaption"},90055:(e,s,r)=>{Promise.resolve().then(r.bind(r,11373))}},e=>{var s=s=>e(e.s=s);e.O(0,[4277,9456,2925,1720,7655,5988,3957,9138,7689,3985,8441,1684,7358],()=>s(90055)),_N_E=e.O()}]);