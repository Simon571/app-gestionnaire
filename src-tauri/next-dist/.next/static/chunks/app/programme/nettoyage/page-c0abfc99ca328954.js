(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4472],{13250:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>D});var a=l(95155),t=l(12115),n=l(66695),c=l(85127),r=l(59409),i=l(30285),o=l(54165),d=l(47262),x=l(62523),h=l(85057),m=l(55365),u=l(14636),j=l(85511),p=l(965),f=l(51920),g=l(73158),v=l(77223),N=l(18018),b=l(7390),w=l(25318),k=l(18046),C=l(73503),M=l(31949),S=l(96019),y=l(65119),A=l(41784),E=l(34548),B=l(16946),P=l(4313),G=l(32714);let L=["Salle principale","Sc\xe8ne","Toilettes","Entr\xe9e et couloirs","Salles annexes","Ext\xe9rieur"],F={"Salle principale":4,Scène:2,Toilettes:2,"Entr\xe9e et couloirs":2,"Salles annexes":2,Extérieur:2},z=(e,s)=>{let l=[];for(let a=0;a<s;a++){let s=(0,S.J)(e,a),t=(0,y.$)(s,{locale:B.fr}),n=(e,s)=>{let l=(0,A.GP)(e,"MMMM",{locale:B.fr}),a=(0,A.GP)(s,"MMMM",{locale:B.fr}),t=(0,A.GP)(e,"dd",{locale:B.fr}),n=(0,A.GP)(s,"dd",{locale:B.fr});return l===a?"".concat(l," ").concat(t,"–").concat(n):"".concat(l," ").concat(t,"–").concat(a," ").concat(n)};l.push(n(s,t))}return l},_=()=>{let e=new Date,s=(0,E.k)(e,{locale:B.fr}),l=(0,y.$)(e,{locale:B.fr}),a=(0,A.GP)(s,"MMMM",{locale:B.fr}),t=(0,A.GP)(l,"MMMM",{locale:B.fr}),n=(0,A.GP)(s,"dd",{locale:B.fr}),c=(0,A.GP)(l,"dd",{locale:B.fr});return a===t?"".concat(a," ").concat(n,"–").concat(c):"".concat(a," ").concat(n,"–").concat(t," ").concat(c)},q=e=>z((0,E.k)(new Date,{locale:B.fr}),24).map(s=>({week:s,...e.reduce((e,s)=>({...e,[s]:[]}),{})}));function D(){let{people:e}=(0,G.d)(),[s,l]=(0,t.useState)(L),[o,d]=(0,t.useState)(F),[x,m]=(0,t.useState)(()=>q(L)),[k,C]=(0,t.useState)(new Date),[M,S]=(0,t.useState)(_()),z=e.map(e=>({value:e.id,label:e.displayName})),D=(0,t.useMemo)(()=>{let s={};return e.forEach(e=>{let l=e.spiritual.group||"unassigned";"unassigned"!==l&&(s[l]||(s[l]=[]),s[l].push(e))}),Object.keys(s).sort().map((e,s)=>({id:e,name:"Groupe ".concat(s+1)}))},[e]),H=D.map(e=>({value:e.id,label:e.name})),I=(s,l)=>{m(a=>a.map(a=>{if(a.week===M){let t;return t="Entretien"===s?l.map(e=>{let s=D.find(s=>s.id===e);return s?s.name:""}).filter(Boolean):l.map(s=>{let l=e.find(e=>e.id===s);return l?l.displayName:""}).filter(Boolean),{...a,[s]:t}}return a}))},R=e=>{l(s=>s.filter(s=>s!==e)),d(s=>{let l={...s};return delete l[e],l}),m(s=>s.map(s=>{let l={...s};return delete l[e],l}))},V=(0,t.useRef)(!0);(0,t.useEffect)(()=>{if(V.current){V.current=!1;return}let e=setTimeout(()=>{console.log("Sauvegarde automatique des donn\xe9es...",x)},1e3);return()=>clearTimeout(e)},[x]);let $=x.find(e=>e.week===M);return(0,a.jsxs)(n.Zp,{children:[(0,a.jsxs)(n.aR,{children:[(0,a.jsx)(n.ZB,{children:"Organisation du Nettoyage"}),(0,a.jsx)(n.BT,{children:"Planifiez et visualisez les affectations pour le nettoyage."})]}),(0,a.jsxs)(n.Wu,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6 p-4 border rounded-lg bg-muted/40",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.Label,{htmlFor:"week-select",className:"sr-only",children:"Semaine"}),(0,a.jsxs)(r.l6,{value:M,onValueChange:S,children:[(0,a.jsx)(r.bq,{id:"week-select",className:"w-[200px]",children:(0,a.jsx)(r.yv,{placeholder:"S\xe9lectionner une semaine"})}),(0,a.jsx)(r.gC,{children:x.map(e=>(0,a.jsx)(r.eb,{value:e.week,children:e.week},e.week))})]}),(0,a.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(p.A,{className:"h-4 w-4"})}),(0,a.jsxs)(u.AM,{children:[(0,a.jsx)(u.Wv,{asChild:!0,children:(0,a.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})}),(0,a.jsx)(u.hl,{className:"w-auto p-0",onInteractOutside:e=>{e.preventDefault()},children:(0,a.jsx)(j.V,{mode:"single",selected:k,onSelect:e=>{let s;if(!e)return;C(e);let l=(0,E.k)(e,{locale:B.fr}),a=(0,y.$)(e,{locale:B.fr}),t=(0,A.GP)(l,"MMMM",{locale:B.fr}),n=(0,A.GP)(a,"MMMM",{locale:B.fr}),c=(0,A.GP)(l,"dd",{locale:B.fr}),r=(0,A.GP)(a,"dd",{locale:B.fr});S(t===n?"".concat(t," ").concat(c,"–").concat(r):"".concat(t," ").concat(c,"–").concat(n," ").concat(r))},initialFocus:!0})})]}),(0,a.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(g.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(O,{onAddService:(e,a)=>{let t=e.replace(/ /g,"_");if(s.includes(t))return void alert("Ce service existe d\xe9j\xe0.");l(e=>[...e,t]),d(e=>({...e,[t]:a})),m(e=>e.map(e=>({...e,[t]:[]})))}}),(0,a.jsxs)(i.Button,{variant:"outline",onClick:()=>{m(e=>e.map(e=>{if(e.week===M){let l={...e};return s.forEach(e=>{l[e]=[]}),l}return e}))},children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Effacer"]}),(0,a.jsx)(T,{rolePersonCounts:o}),(0,a.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>window.print(),children:(0,a.jsx)(N.A,{className:"h-4 w-4"})}),(0,a.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-red-500 text-center",children:M}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:s.map(s=>{let l,t="Entretien"===s,n=(null==$?void 0:$[s])||[];return l=t?D.filter(e=>n.includes(e.name)).map(e=>e.id):e.filter(e=>n.includes(e.displayName)).map(e=>e.id),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(h.Label,{children:s.replace(/_/g," ")}),(0,a.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:()=>R(s),children:(0,a.jsx)(w.A,{className:"h-4 w-4"})})]}),(0,a.jsx)(P.K,{options:t?H:z,selected:l,onChange:e=>I(s,e),placeholder:"S\xe9lectionner..."})]},s)})})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(c.XI,{children:[(0,a.jsx)(c.A0,{children:(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nd,{className:"w-[180px]",children:"Date"}),s.map(e=>(0,a.jsx)(c.nd,{children:e.replace(/_/g," ")},e))]})}),(0,a.jsx)(c.BF,{children:x.map(e=>(0,a.jsxs)(c.Hj,{className:e.week===_()?"bg-yellow-100/70":"",children:[(0,a.jsx)(c.nA,{className:"font-medium",children:e.week}),s.map(s=>(0,a.jsx)(c.nA,{children:(0,a.jsx)("div",{className:"flex flex-col gap-1",children:(e[s]||[]).map((e,s)=>(0,a.jsx)("span",{className:"h-6",children:e},s))})},s))]},e.week))})]})})]})]})}function O(e){let{onAddService:s}=e,[l,n]=(0,t.useState)(!1),[c,r]=(0,t.useState)(""),[d,m]=(0,t.useState)(1);return(0,a.jsxs)(o.lG,{open:l,onOpenChange:n,children:[(0,a.jsx)(o.zM,{asChild:!0,children:(0,a.jsxs)(i.Button,{variant:"outline",children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Ajouter une t\xe2che"]})}),(0,a.jsxs)(o.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsx)(o.c7,{children:(0,a.jsx)(o.L3,{children:"Ajouter une nouvelle t\xe2che"})}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(h.Label,{htmlFor:"role-name",className:"text-right",children:"Nom"}),(0,a.jsx)(x.p,{id:"role-name",value:c,onChange:e=>r(e.target.value),className:"col-span-3",placeholder:"Ex: Entretien"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(h.Label,{htmlFor:"person-count",className:"text-right",children:"Personnes"}),(0,a.jsx)(x.p,{id:"person-count",type:"number",value:d,onChange:e=>m(parseInt(e.target.value,10)||1),className:"col-span-3",min:"1"})]})]}),(0,a.jsx)(o.Es,{children:(0,a.jsx)(i.Button,{onClick:()=>{c.trim()&&(s(c.trim(),d),r(""),m(1),n(!1))},children:"Ajouter la t\xe2che"})})]})]})}function T(e){let{rolePersonCounts:s}=e,[l,n]=(0,t.useState)(!1);return(0,a.jsxs)(o.lG,{open:l,onOpenChange:n,children:[(0,a.jsx)(o.zM,{asChild:!0,children:(0,a.jsxs)(i.Button,{variant:"outline",children:[(0,a.jsx)(C.A,{className:"mr-2 h-4 w-4"}),"Saisie automatique"]})}),(0,a.jsxs)(o.Cf,{className:"sm:max-w-[600px]",children:[(0,a.jsx)(o.c7,{children:(0,a.jsx)(o.L3,{children:"Param\xe8tres de la saisie automatique"})}),(0,a.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(h.Label,{className:"font-semibold",children:"Choisir les t\xe2ches et le nombre de personnes"}),Object.entries(s).map(e=>{let[s,l]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(h.Label,{htmlFor:s,className:"flex-1",children:s.replace(/_/g," ")}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:[...Array(l)].map((e,l)=>(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(d.S,{id:"".concat(s,"-").concat(l+1)}),(0,a.jsx)(h.Label,{htmlFor:"".concat(s,"-").concat(l+1),className:"text-sm font-normal",children:l+1})]},l))})]},s)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(h.Label,{htmlFor:"weeks-count",children:"Semaines pour l'attribution"}),(0,a.jsxs)(r.l6,{children:[(0,a.jsx)(r.bq,{id:"weeks-count",children:(0,a.jsx)(r.yv,{placeholder:"Nombre de semaines"})}),(0,a.jsx)(r.gC,{children:[2,3,4,5,6,7,8].map(e=>(0,a.jsxs)(r.eb,{value:String(e),children:[e," semaines"]},e))})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(h.Label,{htmlFor:"attribution-criteria",children:"Command\xe9 par"}),(0,a.jsxs)(r.l6,{children:[(0,a.jsx)(r.bq,{id:"attribution-criteria",children:(0,a.jsx)(r.yv,{placeholder:"Crit\xe8re d'attribution"})}),(0,a.jsxs)(r.gC,{children:[(0,a.jsx)(r.eb,{value:"recent",children:"Service r\xe9cent"}),(0,a.jsx)(r.eb,{value:"rotation",children:"Rotation"}),(0,a.jsx)(r.eb,{value:"random",children:"Al\xe9atoire"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,a.jsx)(d.S,{id:"check-existing",defaultChecked:!0}),(0,a.jsx)(h.Label,{htmlFor:"check-existing",className:"font-normal",children:"V\xe9rifier l’attribution existante"})]}),(0,a.jsxs)(m.Fc,{variant:"destructive",className:"mt-4",children:[(0,a.jsx)(M.A,{className:"h-4 w-4"}),(0,a.jsx)(m.TN,{children:"Cette action va \xe9craser toutes les futures affectations pour les r\xf4les et semaines s\xe9lectionn\xe9s."})]})]}),(0,a.jsxs)(o.Es,{children:[(0,a.jsx)(o.HM,{asChild:!0,children:(0,a.jsx)(i.Button,{type:"button",variant:"secondary",children:"❌ Annuler"})}),(0,a.jsx)(i.Button,{type:"button",onClick:()=>{console.log("Lancement de la saisie automatique..."),n(!1),alert("Saisie automatique effectu\xe9e (simulation) !")},children:"\uD83D\uDFE6 Saisie automatique"})]})]})]})}},84606:(e,s,l)=>{Promise.resolve().then(l.bind(l,13250))}},e=>{var s=s=>e(e.s=s);e.O(0,[4277,9456,2925,1720,5988,3957,2985,7344,7689,1678,4860,8441,1684,7358],()=>s(84606)),_N_E=e.O()}]);